{
"id":116,
"guid":"70DDFCB8DA18EE118C5C32A5A9F17050",
"pagename":"Hands-on-with-Delphi-Volume-3.html",
"datalevel":9,
"dataversion":1,
"name":"Hands-on with Delphi - Volume 3",
"lang":"en",
"pubdate":"20210722",
"isbn13":"9798690375928",
"website":"https:\/\/www.holgerscode.com\/books\/2021\/07\/23\/multi-tier-cross-platform-data-access-and-visualization-in-grids\/",
"authors":[
{
"id":13,
"guid":"9A22FCB8DA18EE118C5C32A5A9F17050",
"pagename":"Dr-Holger-Flick.html",
"datalevel":6,
"dataversion":1}],
"publishers":[
{
"id":5,
"guid":"F21EFDB8DA18EE118C5C32A5A9F17050",
"pagename":"FlixEngineering.html",
"datalevel":4,
"dataversion":1,
"label":"FlixEngineering"}],
"descriptions":[
{
"guid":"E8DDFCB8DA18EE118C5C32A5A9F17050",
"pagename":"",
"datalevel":3,
"dataversion":1,
"lang":"en",
"text":"<p>Learn to build and deploy modern, multi-tier data-driven Delphi applications for multiple platforms with the Visual Component Library (VCL), FireMonkey (FMX), and TMS WEB Core!<\/p>\n<p>Become a VCL UI Grid Control Insider!<\/p>\n<p>Get to know TAdvStringGrid and its data-aware counterpart TDBAdvGrid in detail. Starting with basic examples, use HTML, insert images, export and import data, customize navigation and mouse-interaction. In-depth look at sorting, editing, filters, and grouping with real-world examples<\/p>\n<p>Efficiently work with data from text files, embed it in your executable, or use FireDAC with SQLite. Write asynchronous, non-blocking code<\/p>\n<p>Use vector images in your grid, browse ZIP archives, and export reports to Microsoft Excel and Adobe PDF<\/p>\n<p>Take the fear out of complex multi-tier Delphi projects!<\/p>\n<p>Step-by-step you will learn to build a database, add a Web service, write clients for Windows, Smartphones, and the Web!<\/p>\n<p>Learn how to deploy your Web services as Windows Services and manage them using a Web interface as part of your service<\/p>\n<p>Test and add documentation with Swagger UI<\/p>\n<p>Easily retrieve diagnostic information to monitor your services with Windows Management Instrumentation<\/p>\n<p>Build Web and cross-platform desktop applications with TMS Web Core and the powerful TMS Miletus sharing the same code base<\/p>"}],
"tocs":[
{
"guid":"10DEFCB8DA18EE118C5C32A5A9F17050",
"pagename":"",
"datalevel":3,
"dataversion":1,
"lang":"en",
"text":"<p>1 Preface\n1.1 About the series . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17\n1.2 Required programming skills . . . . . . . . . . . . . . . . . . . . . . 18\n1.3 Structure of the book . . . . . . . . . . . . . . . . . . . . . . . . . . . 18\n1.4 Technical review . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19\n1.5 Author . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19<\/p>\n<p>2 Introduction 21\n2.1 Required licenses . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21\n2.2 Downloading the source code . . . . . . . . . . . . . . . . . . . . . . 23\n2.3 Disclaimer . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24\n2.4 Typesetting . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25\n2.4.1 Screenshots . . . . . . . . . . . . . . . . . . . . . . . . . . . 25\n2.4.2 Source code . . . . . . . . . . . . . . . . . . . . . . . . . . . 25\n2.4.3 Keyboard and mouse . . . . . . . . . . . . . . . . . . . . . . 26\n2.4.4 References to other books . . . . . . . . . . . . . . . . . . . 26\n2.5 Getting help reproducing the examples . . . . . . . . . . . . . . . . . 26<\/p>\n<p><strong>I VCL Grid Controls<\/strong><\/p>\n<p>3 TAdvStringGrid 29\n3.1 Compatibility with Delphi versions . . . . . . . . . . . . . . . . . . . 29\n3.2 Getting started . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30\n3.2.1 Cell types . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30\n3.2.2 Dimensions . . . . . . . . . . . . . . . . . . . . . . . . . . . 30\n3.2.3 Writing text into cells . . . . . . . . . . . . . . . . . . . . . 34\n3.2.4 Handling mouse clicks . . . . . . . . . . . . . . . . . . . . . 36\n3.2.4.1 OnCellClick with row selection . . . . . . . . . . . . 36\n3.2.4.2 Determine selected cell(s) without mouse click . . . 37\n3.2.4.3 Determine selected rows(s) without mouse click . . 38\n3.2.5 Changing dimensions . . . . . . . . . . . . . . . . . . . . . 38\n3.2.6 Quickly generating test data . . . . . . . . . . . . . . . . . . 38\n3.2.7 Bundled examples . . . . . . . . . . . . . . . . . . . . . . . 41\n3.2.7.1 List of examples . . . . . . . . . . . . . . . . . . . . 42\n3.2.7.2 Locating the examples . . . . . . . . . . . . . . . . . 44\n3.2.8 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45\n3.3 Static, virtual, and dynamic cells . . . . . . . . . . . . . . . . . . . . 45\n3.3.1 Static cell properties . . . . . . . . . . . . . . . . . . . . . . 46\n3.3.2 Using virtual cells . . . . . . . . . . . . . . . . . . . . . . . 48\n3.3.2.1 Changing cell data for display . . . . . . . . . . . . . 50\n3.3.2.2 Provide data on demand using virtual cells . . . . . 53\n3.3.3 Dynamic cell properties . . . . . . . . . . . . . . . . . . . . 54\n3.3.3.1 State of the grid . . . . . . . . . . . . . . . . . . . . 54\n3.3.3.2 Color . . . . . . . . . . . . . . . . . . . . . . . . . . 56\n3.3.3.3 Color gradient . . . . . . . . . . . . . . . . . . . . . 57\n3.3.3.4 Alignment . . . . . . . . . . . . . . . . . . . . . . . 59\n3.3.3.5 Mouse cursor . . . . . . . . . . . . . . . . . . . . . . 61\n3.4 Using HTML . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 62\n3.4.1 Images stored in PictureContainer and GridImages . . . . . 63\n3.4.2 Supported tags . . . . . . . . . . . . . . . . . . . . . . . . . 64\n3.4.3 Where to insert HTML tags . . . . . . . . . . . . . . . . . . 76\n3.5 Organizing rows and columns . . . . . . . . . . . . . . . . . . . . . . 76\n3.5.1 Size . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76\n3.5.1.1 Persisting column widths . . . . . . . . . . . . . . . 79\n3.5.1.2 Stretching . . . . . . . . . . . . . . . . . . . . . . . 79\n3.5.2 Reordering (moving) . . . . . . . . . . . . . . . . . . . . . . 81\n3.5.3 Hidden columns and rows . . . . . . . . . . . . . . . . . . . 85\n3.5.4 Merging . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 91\n3.5.5 Grouping . . . . . . . . . . . . . . . . . . . . . . . . . . . . 93\n3.6 Loading and writing grid data . . . . . . . . . . . . . . . . . . . . . . 98\n3.6.1 Customizing saving and loading . . . . . . . . . . . . . . . . 100\n3.6.2 Creating PDF files . . . . . . . . . . . . . . . . . . . . . . . 101\n3.6.2.1 Document options . . . . . . . . . . . . . . . . . . . 101\n3.6.2.2 Document information . . . . . . . . . . . . . . . . 106\n3.6.2.3 Example . . . . . . . . . . . . . . . . . . . . . . . . 106\n3.7 Navigating . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 108\n3.7.1 Keyboard . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110\n3.7.2 Mouse . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 119\n3.8 Sorting . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 125\n3.8.1 Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 126\n3.8.2 Storing and loading . . . . . . . . . . . . . . . . . . . . . . 130\n3.8.3 Sort styles . . . . . . . . . . . . . . . . . . . . . . . . . . . . 131\n3.8.3.1 Manually specifying the cell format . . . . . . . . . 133\n3.8.3.2 Custom sorting . . . . . . . . . . . . . . . . . . . . . 134\n3.8.4 Events . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 136\n3.8.5 Ignoring columns . . . . . . . . . . . . . . . . . . . . . . . . 138\n3.8.6 Row indexes before and after sorting . . . . . . . . . . . . . 139\n3.8.7 Triggering sorting at run-time . . . . . . . . . . . . . . . . . 139\n3.8.7.1 Single column . . . . . . . . . . . . . . . . . . . . . 140\n3.8.7.2 Sort column sequences . . . . . . . . . . . . . . . . 140\n3.8.8 Example . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 141\n3.9 Editing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 144\n3.9.1 Enabling editing for all cells . . . . . . . . . . . . . . . . . . 145\n3.9.2 Read-only cells . . . . . . . . . . . . . . . . . . . . . . . . . 147\n3.9.3 Starting the edit process using code . . . . . . . . . . . . . . 148\n3.9.4 Inplace editors . . . . . . . . . . . . . . . . . . . . . . . . . 148\n3.9.4.1 Defining an inplace editor . . . . . . . . . . . . . . . 150\n3.9.4.2 Restricting the length of input . . . . . . . . . . . . 151\n3.9.4.3 Using masks . . . . . . . . . . . . . . . . . . . . . . 151\n3.9.4.4 Spin editors . . . . . . . . . . . . . . . . . . . . . . . 154\n3.9.4.5 Combo boxes . . . . . . . . . . . . . . . . . . . . . . 156\n3.9.5 Validating user input . . . . . . . . . . . . . . . . . . . . . . 160\n3.10 Undo & Redo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 163<\/p>\n<p>4 TDBAdvGrid: Data-aware TAdvStringGrid 165\n4.1 How is data linked to the grid? . . . . . . . . . . . . . . . . . . . . . 169\n4.1.1 Assigning the datasource . . . . . . . . . . . . . . . . . . . . 169\n4.1.2 Defining columns . . . . . . . . . . . . . . . . . . . . . . . . 169\n4.2 PageMode is key! . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 170\n4.3 EditPostMode determines when data is posted . . . . . . . . . . . . . 171<\/p>\n<p><strong>II Hands-on Examples<\/strong><\/p>\n<p>5 Assorted grid examples 175\n5.1 VCL: Loading big CSV data files asynchronously . . . . . . . . . . . . 175\n5.1.1 Downloading the data . . . . . . . . . . . . . . . . . . . . . 176\n5.1.2 Why we use a resource . . . . . . . . . . . . . . . . . . . . . 178\n5.1.3 Adding the resource . . . . . . . . . . . . . . . . . . . . . . 180\n5.1.4 Loading the resource at run-time . . . . . . . . . . . . . . . 184\n5.1.5 Indicating activity . . . . . . . . . . . . . . . . . . . . . . . 186\n5.1.6 Loading data asynchronously . . . . . . . . . . . . . . . . . 188\n5.2 Browsing data from an SQLite database . . . . . . . . . . . . . . . . 195\n5.2.1 Creating an SQLite database with Array DML . . . . . . . . 196\n5.2.2 Changing the browser app to SQLite . . . . . . . . . . . . . 202\n5.3 Browsing data with a filter . . . . . . . . . . . . . . . . . . . . . . . . 208\n5.3.1 Populating the combo box . . . . . . . . . . . . . . . . . . . 210\n5.3.2 Showing only data for one state . . . . . . . . . . . . . . . . 211\n5.3.3 Initializing the user interface . . . . . . . . . . . . . . . . . 211\n5.3.4 Loading data for a state . . . . . . . . . . . . . . . . . . . . 214\n5.3.5 Adding eye candy . . . . . . . . . . . . . . . . . . . . . . . . 216\n5.4 Using vector images in TAdvStringGrid . . . . . . . . . . . . . . . . . 217\n5.4.1 Components on the main form . . . . . . . . . . . . . . . . 219\n5.4.2 Application Settings . . . . . . . . . . . . . . . . . . . . . . 227\n5.4.3 TIconItem: Container for icons . . . . . . . . . . . . . . . . 230\n5.4.4 Fields and properties of the main form . . . . . . . . . . . . 231\n5.4.5 Setting up the grid . . . . . . . . . . . . . . . . . . . . . . . 234\n5.4.6 Folder selection . . . . . . . . . . . . . . . . . . . . . . . . . 238\n5.4.7 Updating the image list . . . . . . . . . . . . . . . . . . . . 239\n5.4.8 Loading icons from a folder . . . . . . . . . . . . . . . . . . 240\n5.4.9 Loading icons stored in a ZIP archive . . . . . . . . . . . . . 242\n5.4.10 Export to Microsoft Excel . . . . . . . . . . . . . . . . . . . 245\n5.4.11 Reacting to display resolution changes . . . . . . . . . . . . 247<\/p>\n<p>6 Multi-tier, cross-platform development 249\n6.1 Building the database . . . . . . . . . . . . . . . . . . . . . . . . . . 251\n6.1.1 Creating the database . . . . . . . . . . . . . . . . . . . . . 252\n6.1.2 Postal code table . . . . . . . . . . . . . . . . . . . . . . . . 254\n6.1.2.1 Source . . . . . . . . . . . . . . . . . . . . . . . . . 254\n6.1.2.2 Usage restrictions . . . . . . . . . . . . . . . . . . . 254\n6.1.2.3 Attributes . . . . . . . . . . . . . . . . . . . . . . . . 256\n6.1.2.4 Creating the table . . . . . . . . . . . . . . . . . . . 256\n6.1.2.5 Sample data . . . . . . . . . . . . . . . . . . . . . . 257\n6.1.3 Country codes . . . . . . . . . . . . . . . . . . . . . . . . . 257\n6.1.3.1 Source . . . . . . . . . . . . . . . . . . . . . . . . . 258\n6.1.3.2 Usage restrictions . . . . . . . . . . . . . . . . . . . 258\n6.1.3.3 Attributes . . . . . . . . . . . . . . . . . . . . . . . . 258\n6.1.3.4 Creating the table . . . . . . . . . . . . . . . . . . . 258\n6.1.3.5 Sample data . . . . . . . . . . . . . . . . . . . . . . 260\n6.2 TMS XData: Web services . . . . . . . . . . . . . . . . . . . . . . . . 260\n6.2.1 Creating the server application . . . . . . . . . . . . . . . . 261\n6.2.2 Class for Web service data . . . . . . . . . . . . . . . . . . . 262\n6.2.3 Database access . . . . . . . . . . . . . . . . . . . . . . . . . 266\n6.2.4 Providing a connection . . . . . . . . . . . . . . . . . . . . . 268\n6.2.5 Using the GetConnection method . . . . . . . . . . . . . . . 271\n6.2.6 Querying the database . . . . . . . . . . . . . . . . . . . . . 272\n6.2.7 Mandatory units . . . . . . . . . . . . . . . . . . . . . . . . 275\n6.2.8 Defining the service interface . . . . . . . . . . . . . . . . . 275\n6.2.9 Implementing the service method . . . . . . . . . . . . . . . 278\n6.2.10 Database client libraries . . . . . . . . . . . . . . . . . . . . 280\n6.2.11 Adding a custom route . . . . . . . . . . . . . . . . . . . . . 282\n6.2.12 Browse your services with Swagger UI . . . . . . . . . . . . 283\n6.2.13 Adding documentation for Swagger UI . . . . . . . . . . . . 287\n6.2.13.1 XMLDoc in Delphi . . . . . . . . . . . . . . . . . . . 292\n6.2.13.2 Swagger-specific tags . . . . . . . . . . . . . . . . . 292\n6.2.13.3 Excluding methods from Swagger . . . . . . . . . . 294\n6.3 VCL: Implementing a desktop client for lookup . . . . . . . . . . . . 295\n6.3.1 Designing the main form . . . . . . . . . . . . . . . . . . . . 296\n6.3.2 Retrieving data from the Web service . . . . . . . . . . . . . 298\n6.3.3 Implementing the user events . . . . . . . . . . . . . . . . . 303\n6.3.4 Customizing the grid control . . . . . . . . . . . . . . . . . 304\n6.3.5 A word on T(Virtual)ImageList . . . . . . . . . . . . . . . . 305\n6.4 FMX: Mobile app to lookup postal codes . . . . . . . . . . . . . . . . 305\n6.4.1 The worst...comes first . . . . . . . . . . . . . . . . . . . . . 306\n6.4.2 HTTP and HTTPS in Android apps . . . . . . . . . . . . . . 306\n6.4.3 Building the user interface . . . . . . . . . . . . . . . . . . . 308\n6.4.4 Retrieving data from the Web service . . . . . . . . . . . . . 311\n6.5 TMS WEB Core: Web client application . . . . . . . . . . . . . . . . . 315\n6.5.1 Designing the main form . . . . . . . . . . . . . . . . . . . . 316\n6.5.2 Connecting to the XData server . . . . . . . . . . . . . . . . 318\n6.5.3 Calling the service method . . . . . . . . . . . . . . . . . . . 318\n6.5.4 Processing the result and updating the grid . . . . . . . . . 319\n6.6 VCL: Using the Web service for efficient data entry . . . . . . . . . . 323\n6.6.1 Designing the user interface . . . . . . . . . . . . . . . . . . 325\n6.6.2 Fields and constants in the form . . . . . . . . . . . . . . . 325\n6.6.3 Initializing the form and grid . . . . . . . . . . . . . . . . . 327\n6.6.4 Saving and loading the grid values . . . . . . . . . . . . . . 328\n6.6.5 Setup for editing . . . . . . . . . . . . . . . . . . . . . . . . 329\n6.6.6 Retrieving data from the Web service . . . . . . . . . . . . . 331\n6.6.7 Evaluating the size of Web service results . . . . . . . . . . 332\n6.6.8 Validation of postal codes . . . . . . . . . . . . . . . . . . . 337\n6.6.9 Selection from a combo box . . . . . . . . . . . . . . . . . . 338\n6.7 TMS XData: Deployment as Windows service . . . . . . . . . . . . . 340\n6.7.1 Windows application vs. Windows service . . . . . . . . . . 341\n6.7.2 Migrating an existing server project . . . . . . . . . . . . . . 342\n6.7.2.1 Thanks to Wagner Landgraf and outlook . . . . . . . 342\n6.7.2.2 Adding service information to the service container . 343\n6.7.2.3 Starting and stopping the server . . . . . . . . . . . 346\n6.7.2.4 Adding the Windows service class . . . . . . . . . . 347\n6.7.2.5 Helper methods to extend framework classes . . . . 349\n6.7.2.6 Updating the project source file . . . . . . . . . . . . 350\n6.7.2.7 Custom Command-line switch . . . . . . . . . . . . 353\n6.8 TMS XData: Configuration of Web Services at run-time . . . . . . . . 353\n6.8.1 Settings for IPostalService . . . . . . . . . . . . . . . . . . . 354\n6.8.1.1 Settings for the database connection . . . . . . . . . 355\n6.8.1.2 Settings for the server . . . . . . . . . . . . . . . . . 355\n6.8.1.3 TServerSettings class . . . . . . . . . . . . . . . . . 355\n6.8.1.4 Server status . . . . . . . . . . . . . . . . . . . . . . 359\n6.8.2 Defining the configuration service . . . . . . . . . . . . . . . 359\n6.8.3 Models, services, and endpoints . . . . . . . . . . . . . . . . 360\n6.8.4 Implementing the configuration service . . . . . . . . . . . 361\n6.8.5 Adding a second XData server . . . . . . . . . . . . . . . . . 362\n6.8.5.1 Implementing the Singleton pattern . . . . . . . . . 364\n6.8.5.2 Implementing methods to start and stop the data\nserver . . . . . . . . . . . . . . . . . . . . . . . . . . 366\n6.8.6 Adding services to the second XData server . . . . . . . . . 368\n6.8.6.1 Updating the postal service . . . . . . . . . . . . . . 369\n6.8.7 Adding start and stop to the configuration service . . . . . . 372\n6.8.8 Automatic reservation of endpoints . . . . . . . . . . . . . . 374\n6.8.9 Using the configuration service . . . . . . . . . . . . . . . . 377\n6.9 TMS WEB Core: Building a Web interface . . . . . . . . . . . . . . . 378\n6.9.1 Designing the main form . . . . . . . . . . . . . . . . . . . . 378\n6.9.2 Data module for XData connectivity . . . . . . . . . . . . . 385\n6.9.3 Initiating the connection from the main form . . . . . . . . 387\n6.9.4 Retrieving the server configuration . . . . . . . . . . . . . . 388\n6.9.5 Sending settings to the server . . . . . . . . . . . . . . . . . 394\n6.9.6 Starting the service . . . . . . . . . . . . . . . . . . . . . . . 397\n6.9.7 Stopping the service . . . . . . . . . . . . . . . . . . . . . . 400\n6.10 Adding a Web server to an XData server . . . . . . . . . . . . . . . . 401\n6.11 VCL: Updating the user interface with vectors . . . . . . . . . . . . . 403\n6.11.1 Adding vector images . . . . . . . . . . . . . . . . . . . . . 404\n6.11.2 Implementing the config button . . . . . . . . . . . . . . . . 406\n6.12 TMS XData: Monitoring critical server parameters . . . . . . . . . . . 406\n6.12.1 Hardware being monitored . . . . . . . . . . . . . . . . . . 407\n6.12.2 Getting the hardware info . . . . . . . . . . . . . . . . . . . 408\n6.12.3 Implementing the service methods . . . . . . . . . . . . . . 415\n6.13 TMS WEB Core: Adding monitoring to the Web client . . . . . . . . . 420\n6.13.1 Updating the service controller . . . . . . . . . . . . . . . . 420\n6.13.2 Adding the popup window . . . . . . . . . . . . . . . . . . . 425\n6.13.3 Appearance of the caption . . . . . . . . . . . . . . . . . . . 434\n6.13.4 Closing the pop-up window . . . . . . . . . . . . . . . . . . 435\n6.13.5 Showing the pop-up window . . . . . . . . . . . . . . . . . 435\n6.14 TMS Miletus: Creating a Windows client . . . . . . . . . . . . . . . . 438\n6.14.1 Looking at the finished application . . . . . . . . . . . . . . 440\n6.14.2 Create a new TMS Miletus application . . . . . . . . . . . . 443\n6.14.3 Updating the project file . . . . . . . . . . . . . . . . . . . . 445\n6.14.4 Migrating the service controller . . . . . . . . . . . . . . . . 445\n6.14.5 Migrating the main form . . . . . . . . . . . . . . . . . . . . 446\n6.14.6 Updating the pop-up window . . . . . . . . . . . . . . . . . 449\n6.14.7 Running the application . . . . . . . . . . . . . . . . . . . . 451<\/p>\n<p>7 Appendix\n7.1 Internet Component Suite (ICS) . . . . . . . . . . . . . . . . . . . . . 453\n7.1.1 Download . . . . . . . . . . . . . . . . . . . . . . . . . . . . 453\n7.1.2 List of components . . . . . . . . . . . . . . . . . . . . . . . 454\n7.1.3 List of examples . . . . . . . . . . . . . . . . . . . . . . . . 455\n7.1.4 Legal . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 456\n7.2 TColors . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 457\n7.3 References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 459<\/p>"
},{

"guid":"38DEFCB8DA18EE118C5C32A5A9F17050",
"pagename":"",
"datalevel":3,
"dataversion":1,
"lang":"en",
"text":"<p>1 Preface\n1.1 About the series . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17<br>\n1.2 Required programming skills . . . . . . . . . . . . . . . . . . . . . . 18<br>\n1.3 Structure of the book . . . . . . . . . . . . . . . . . . . . . . . . . . . 18<br>\n1.4 Technical review . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19<br>\n1.5 Author . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19<\/p>\n<p>2 Introduction<br>\n2.1 Required licenses . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21<br>\n2.2 Downloading the source code . . . . . . . . . . . . . . . . . . . . . . 23<br>\n2.3 Disclaimer . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24<br>\n2.4 Typesetting . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25<br>\n2.4.1 Screenshots . . . . . . . . . . . . . . . . . . . . . . . . . . . 25<br>\n2.4.2 Source code . . . . . . . . . . . . . . . . . . . . . . . . . . . 25<br>\n2.4.3 Keyboard and mouse . . . . . . . . . . . . . . . . . . . . . . 26<br>\n2.4.4 References to other books . . . . . . . . . . . . . . . . . . . 26<br>\n2.5 Getting help reproducing the examples . . . . . . . . . . . . . . . . . 26<\/p>\n<p><strong>I VCL Grid Controls<\/strong><\/p>\n<p>3 TAdvStringGrid<br>\n3.1 Compatibility with Delphi versions . . . . . . . . . . . . . . . . . . . 29<br>\n3.2 Getting started . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30<br>\n3.2.1 Cell types . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30<br>\n3.2.2 Dimensions . . . . . . . . . . . . . . . . . . . . . . . . . . . 30<br>\n3.2.3 Writing text into cells . . . . . . . . . . . . . . . . . . . . . 34<br>\n3.2.4 Handling mouse clicks . . . . . . . . . . . . . . . . . . . . . 36<br>\n3.2.4.1 OnCellClick with row selection . . . . . . . . . . . . 36<br>\n3.2.4.2 Determine selected cell(s) without mouse click . . . 37<br>\n3.2.4.3 Determine selected rows(s) without mouse click . . 38<br>\n3.2.5 Changing dimensions . . . . . . . . . . . . . . . . . . . . . 38<br>\n3.2.6 Quickly generating test data . . . . . . . . . . . . . . . . . . 38<br>\n3.2.7 Bundled examples . . . . . . . . . . . . . . . . . . . . . . . 41<br>\n3.2.7.1 List of examples . . . . . . . . . . . . . . . . . . . . 42<br>\n3.2.7.2 Locating the examples . . . . . . . . . . . . . . . . . 44<br>\n3.2.8 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45<br>\n3.3 Static, virtual, and dynamic cells . . . . . . . . . . . . . . . . . . . . 45<br>\n3.3.1 Static cell properties . . . . . . . . . . . . . . . . . . . . . . 46<br>\n3.3.2 Using virtual cells . . . . . . . . . . . . . . . . . . . . . . . 48<br>\n3.3.2.1 Changing cell data for display . . . . . . . . . . . . . 50<br>\n3.3.2.2 Provide data on demand using virtual cells . . . . . 53<br>\n3.3.3 Dynamic cell properties . . . . . . . . . . . . . . . . . . . . 54<br>\n3.3.3.1 State of the grid . . . . . . . . . . . . . . . . . . . . 54<br>\n3.3.3.2 Color . . . . . . . . . . . . . . . . . . . . . . . . . . 56<br>\n3.3.3.3 Color gradient . . . . . . . . . . . . . . . . . . . . . 57<br>\n3.3.3.4 Alignment . . . . . . . . . . . . . . . . . . . . . . . 59<br>\n3.3.3.5 Mouse cursor . . . . . . . . . . . . . . . . . . . . . . 61<br>\n3.4 Using HTML . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 62<br>\n3.4.1 Images stored in PictureContainer and GridImages . . . . . 63<br>\n3.4.2 Supported tags . . . . . . . . . . . . . . . . . . . . . . . . . 64<br>\n3.4.3 Where to insert HTML tags . . . . . . . . . . . . . . . . . . 76<br>\n3.5 Organizing rows and columns . . . . . . . . . . . . . . . . . . . . . . 76<br>\n3.5.1 Size . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76<br>\n3.5.1.1 Persisting column widths . . . . . . . . . . . . . . . 79<br>\n3.5.1.2 Stretching . . . . . . . . . . . . . . . . . . . . . . . 79<br>\n3.5.2 Reordering (moving) . . . . . . . . . . . . . . . . . . . . . . 81<br>\n3.5.3 Hidden columns and rows . . . . . . . . . . . . . . . . . . . 85<br>\n3.5.4 Merging . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 91<br>\n3.5.5 Grouping . . . . . . . . . . . . . . . . . . . . . . . . . . . . 93<br>\n3.6 Loading and writing grid data . . . . . . . . . . . . . . . . . . . . . . 98<br>\n3.6.1 Customizing saving and loading . . . . . . . . . . . . . . . . 100<br>\n3.6.2 Creating PDF files . . . . . . . . . . . . . . . . . . . . . . . 101<br>\n3.6.2.1 Document options . . . . . . . . . . . . . . . . . . . 101<br>\n3.6.2.2 Document information . . . . . . . . . . . . . . . . 106<br>\n3.6.2.3 Example . . . . . . . . . . . . . . . . . . . . . . . . 106<br>\n3.7 Navigating . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 108<br>\n3.7.1 Keyboard . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110<br>\n3.7.2 Mouse . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 119<br>\n3.8 Sorting . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 125<br>\n3.8.1 Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 126<br>\n3.8.2 Storing and loading . . . . . . . . . . . . . . . . . . . . . . 130<br>\n3.8.3 Sort styles . . . . . . . . . . . . . . . . . . . . . . . . . . . . 131<br>\n3.8.3.1 Manually specifying the cell format . . . . . . . . . 133<br>\n3.8.3.2 Custom sorting . . . . . . . . . . . . . . . . . . . . . 134<br>\n3.8.4 Events . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 136<br>\n3.8.5 Ignoring columns . . . . . . . . . . . . . . . . . . . . . . . . 138<br>\n3.8.6 Row indexes before and after sorting . . . . . . . . . . . . . 139<br>\n3.8.7 Triggering sorting at run-time . . . . . . . . . . . . . . . . . 139<br>\n3.8.7.1 Single column . . . . . . . . . . . . . . . . . . . . . 140<br>\n3.8.7.2 Sort column sequences . . . . . . . . . . . . . . . . 140<br>\n3.8.8 Example . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 141<br>\n3.9 Editing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 144<br>\n3.9.1 Enabling editing for all cells . . . . . . . . . . . . . . . . . . 145<br>\n3.9.2 Read-only cells . . . . . . . . . . . . . . . . . . . . . . . . . 147<br>\n3.9.3 Starting the edit process using code . . . . . . . . . . . . . . 148<br>\n3.9.4 Inplace editors . . . . . . . . . . . . . . . . . . . . . . . . . 148<br>\n3.9.4.1 Defining an inplace editor . . . . . . . . . . . . . . . 150<br>\n3.9.4.2 Restricting the length of input . . . . . . . . . . . . 151<br>\n3.9.4.3 Using masks . . . . . . . . . . . . . . . . . . . . . . 151<br>\n3.9.4.4 Spin editors . . . . . . . . . . . . . . . . . . . . . . . 154<br>\n3.9.4.5 Combo boxes . . . . . . . . . . . . . . . . . . . . . . 156<br>\n3.9.5 Validating user input . . . . . . . . . . . . . . . . . . . . . . 160<br>\n3.10 Undo & Redo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 163<\/p>\n<p>4 TDBAdvGrid: Data-aware TAdvStringGrid<br>\n4.1 How is data linked to the grid? . . . . . . . . . . . . . . . . . . . . . 169<br>\n4.1.1 Assigning the datasource . . . . . . . . . . . . . . . . . . . . 169<br>\n4.1.2 Defining columns . . . . . . . . . . . . . . . . . . . . . . . . 169<br>\n4.2 PageMode is key! . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 170<br>\n4.3 EditPostMode determines when data is posted . . . . . . . . . . . . . 171<\/p>\n<p><strong>II Hands-on Examples<\/strong><\/p>\n<p>5 Assorted grid examples<br>\n5.1 VCL: Loading big CSV data files asynchronously . . . . . . . . . . . . 175<br>\n5.1.1 Downloading the data . . . . . . . . . . . . . . . . . . . . . 176<br>\n5.1.2 Why we use a resource . . . . . . . . . . . . . . . . . . . . . 178<br>\n5.1.3 Adding the resource . . . . . . . . . . . . . . . . . . . . . . 180<br>\n5.1.4 Loading the resource at run-time . . . . . . . . . . . . . . . 184<br>\n5.1.5 Indicating activity . . . . . . . . . . . . . . . . . . . . . . . 186<br>\n5.1.6 Loading data asynchronously . . . . . . . . . . . . . . . . . 188<br>\n5.2 Browsing data from an SQLite database . . . . . . . . . . . . . . . . 195<br>\n5.2.1 Creating an SQLite database with Array DML . . . . . . . . 196<br>\n5.2.2 Changing the browser app to SQLite . . . . . . . . . . . . . 202<br>\n5.3 Browsing data with a filter . . . . . . . . . . . . . . . . . . . . . . . . 208<br>\n5.3.1 Populating the combo box . . . . . . . . . . . . . . . . . . . 210<br>\n5.3.2 Showing only data for one state . . . . . . . . . . . . . . . . 211<br>\n5.3.3 Initializing the user interface . . . . . . . . . . . . . . . . . 211<br>\n5.3.4 Loading data for a state . . . . . . . . . . . . . . . . . . . . 214<br>\n5.3.5 Adding eye candy . . . . . . . . . . . . . . . . . . . . . . . . 216<br>\n5.4 Using vector images in TAdvStringGrid . . . . . . . . . . . . . . . . . 217<br>\n5.4.1 Components on the main form . . . . . . . . . . . . . . . . 219<br>\n5.4.2 Application Settings . . . . . . . . . . . . . . . . . . . . . . 227<br>\n5.4.3 TIconItem: Container for icons . . . . . . . . . . . . . . . . 230<br>\n5.4.4 Fields and properties of the main form . . . . . . . . . . . . 231<br>\n5.4.5 Setting up the grid . . . . . . . . . . . . . . . . . . . . . . . 234<br>\n5.4.6 Folder selection . . . . . . . . . . . . . . . . . . . . . . . . . 238<br>\n5.4.7 Updating the image list . . . . . . . . . . . . . . . . . . . . 239<br>\n5.4.8 Loading icons from a folder . . . . . . . . . . . . . . . . . . 240<br>\n5.4.9 Loading icons stored in a ZIP archive . . . . . . . . . . . . . 242<br>\n5.4.10 Export to Microsoft Excel . . . . . . . . . . . . . . . . . . . 245<br>\n5.4.11 Reacting to display resolution changes . . . . . . . . . . . . 247<\/p>\n<p>6 Multi-tier, cross-platform development<br>\n6.1 Building the database . . . . . . . . . . . . . . . . . . . . . . . . . . 251<br>\n6.1.1 Creating the database . . . . . . . . . . . . . . . . . . . . . 252<br>\n6.1.2 Postal code table . . . . . . . . . . . . . . . . . . . . . . . . 254<br>\n6.1.2.1 Source . . . . . . . . . . . . . . . . . . . . . . . . . 254<br>\n6.1.2.2 Usage restrictions . . . . . . . . . . . . . . . . . . . 254<br>\n6.1.2.3 Attributes . . . . . . . . . . . . . . . . . . . . . . . . 256<br>\n6.1.2.4 Creating the table . . . . . . . . . . . . . . . . . . . 256<br>\n6.1.2.5 Sample data . . . . . . . . . . . . . . . . . . . . . . 257<br>\n6.1.3 Country codes . . . . . . . . . . . . . . . . . . . . . . . . . 257<br>\n6.1.3.1 Source . . . . . . . . . . . . . . . . . . . . . . . . . 258<br>\n6.1.3.2 Usage restrictions . . . . . . . . . . . . . . . . . . . 258<br>\n6.1.3.3 Attributes . . . . . . . . . . . . . . . . . . . . . . . . 258<br>\n6.1.3.4 Creating the table . . . . . . . . . . . . . . . . . . . 258<br>\n6.1.3.5 Sample data . . . . . . . . . . . . . . . . . . . . . . 260<br>\n6.2 TMS XData: Web services . . . . . . . . . . . . . . . . . . . . . . . . 260<br>\n6.2.1 Creating the server application . . . . . . . . . . . . . . . . 261<br>\n6.2.2 Class for Web service data . . . . . . . . . . . . . . . . . . . 262<br>\n6.2.3 Database access . . . . . . . . . . . . . . . . . . . . . . . . . 266<br>\n6.2.4 Providing a connection . . . . . . . . . . . . . . . . . . . . . 268<br>\n6.2.5 Using the GetConnection method . . . . . . . . . . . . . . . 271<br>\n6.2.6 Querying the database . . . . . . . . . . . . . . . . . . . . . 272<br>\n6.2.7 Mandatory units . . . . . . . . . . . . . . . . . . . . . . . . 275<br>\n6.2.8 Defining the service interface . . . . . . . . . . . . . . . . . 275<br>\n6.2.9 Implementing the service method . . . . . . . . . . . . . . . 278<br>\n6.2.10 Database client libraries . . . . . . . . . . . . . . . . . . . . 280<br>\n6.2.11 Adding a custom route . . . . . . . . . . . . . . . . . . . . . 282<br>\n6.2.12 Browse your services with Swagger UI . . . . . . . . . . . . 283<br>\n6.2.13 Adding documentation for Swagger UI . . . . . . . . . . . . 287<br>\n6.2.13.1 XMLDoc in Delphi . . . . . . . . . . . . . . . . . . . 292<br>\n6.2.13.2 Swagger-specific tags . . . . . . . . . . . . . . . . . 292<br>\n6.2.13.3 Excluding methods from Swagger . . . . . . . . . . 294<br>\n6.3 VCL: Implementing a desktop client for lookup . . . . . . . . . . . . 295<br>\n6.3.1 Designing the main form . . . . . . . . . . . . . . . . . . . . 296<br>\n6.3.2 Retrieving data from the Web service . . . . . . . . . . . . . 298<br>\n6.3.3 Implementing the user events . . . . . . . . . . . . . . . . . 303<br>\n6.3.4 Customizing the grid control . . . . . . . . . . . . . . . . . 304<br>\n6.3.5 A word on T(Virtual)ImageList . . . . . . . . . . . . . . . . 305<br>\n6.4 FMX: Mobile app to lookup postal codes . . . . . . . . . . . . . . . . 305<br>\n6.4.1 The worst...comes first . . . . . . . . . . . . . . . . . . . . . 306<br>\n6.4.2 HTTP and HTTPS in Android apps . . . . . . . . . . . . . . 306<br>\n6.4.3 Building the user interface . . . . . . . . . . . . . . . . . . . 308<br>\n6.4.4 Retrieving data from the Web service . . . . . . . . . . . . . 311<br>\n6.5 TMS WEB Core: Web client application . . . . . . . . . . . . . . . . . 315<br>\n6.5.1 Designing the main form . . . . . . . . . . . . . . . . . . . . 316<br>\n6.5.2 Connecting to the XData server . . . . . . . . . . . . . . . . 318<br>\n6.5.3 Calling the service method . . . . . . . . . . . . . . . . . . . 318<br>\n6.5.4 Processing the result and updating the grid . . . . . . . . . 319<br>\n6.6 VCL: Using the Web service for efficient data entry . . . . . . . . . . 323<br>\n6.6.1 Designing the user interface . . . . . . . . . . . . . . . . . . 325<br>\n6.6.2 Fields and constants in the form . . . . . . . . . . . . . . . 325<br>\n6.6.3 Initializing the form and grid . . . . . . . . . . . . . . . . . 327<br>\n6.6.4 Saving and loading the grid values . . . . . . . . . . . . . . 328<br>\n6.6.5 Setup for editing . . . . . . . . . . . . . . . . . . . . . . . . 329<br>\n6.6.6 Retrieving data from the Web service . . . . . . . . . . . . . 331<br>\n6.6.7 Evaluating the size of Web service results . . . . . . . . . . 332<br>\n6.6.8 Validation of postal codes . . . . . . . . . . . . . . . . . . . 337<br>\n6.6.9 Selection from a combo box . . . . . . . . . . . . . . . . . . 338<br>\n6.7 TMS XData: Deployment as Windows service . . . . . . . . . . . . . 340<br>\n6.7.1 Windows application vs. Windows service . . . . . . . . . . 341<br>\n6.7.2 Migrating an existing server project . . . . . . . . . . . . . . 342<br>\n6.7.2.1 Thanks to Wagner Landgraf and outlook . . . . . . . 342<br>\n6.7.2.2 Adding service information to the service container . 343<br>\n6.7.2.3 Starting and stopping the server . . . . . . . . . . . 346<br>\n6.7.2.4 Adding the Windows service class . . . . . . . . . . 347<br>\n6.7.2.5 Helper methods to extend framework classes . . . . 349<br>\n6.7.2.6 Updating the project source file . . . . . . . . . . . . 350<br>\n6.7.2.7 Custom Command-line switch . . . . . . . . . . . . 353<br>\n6.8 TMS XData: Configuration of Web Services at run-time . . . . . . . . 353<br>\n6.8.1 Settings for IPostalService . . . . . . . . . . . . . . . . . . . 354<br>\n6.8.1.1 Settings for the database connection . . . . . . . . . 355<br>\n6.8.1.2 Settings for the server . . . . . . . . . . . . . . . . . 355<br>\n6.8.1.3 TServerSettings class . . . . . . . . . . . . . . . . . 355<br>\n6.8.1.4 Server status . . . . . . . . . . . . . . . . . . . . . . 359<br>\n6.8.2 Defining the configuration service . . . . . . . . . . . . . . . 359<br>\n6.8.3 Models, services, and endpoints . . . . . . . . . . . . . . . . 360<br>\n6.8.4 Implementing the configuration service . . . . . . . . . . . 361<br>\n6.8.5 Adding a second XData server . . . . . . . . . . . . . . . . . 362<br>\n6.8.5.1 Implementing the Singleton pattern . . . . . . . . . 364<br>\n6.8.5.2 Implementing methods to start and stop the data server . . . . . . . . . . . . . . . . . . . . . . . . . . 366<br>\n6.8.6 Adding services to the second XData server . . . . . . . . . 368<br>\n6.8.6.1 Updating the postal service . . . . . . . . . . . . . . 369<br>\n6.8.7 Adding start and stop to the configuration service . . . . . . 372<br>\n6.8.8 Automatic reservation of endpoints . . . . . . . . . . . . . . 374<br>\n6.8.9 Using the configuration service . . . . . . . . . . . . . . . . 377<br>\n6.9 TMS WEB Core: Building a Web interface . . . . . . . . . . . . . . . 378<br>\n6.9.1 Designing the main form . . . . . . . . . . . . . . . . . . . . 378<br>\n6.9.2 Data module for XData connectivity . . . . . . . . . . . . . 385<br>\n6.9.3 Initiating the connection from the main form . . . . . . . . 387<br>\n6.9.4 Retrieving the server configuration . . . . . . . . . . . . . . 388<br>\n6.9.5 Sending settings to the server . . . . . . . . . . . . . . . . . 394<br>\n6.9.6 Starting the service . . . . . . . . . . . . . . . . . . . . . . . 397<br>\n6.9.7 Stopping the service . . . . . . . . . . . . . . . . . . . . . . 400<br>\n6.10 Adding a Web server to an XData server . . . . . . . . . . . . . . . . 401<br>\n6.11 VCL: Updating the user interface with vectors . . . . . . . . . . . . . 403<br>\n6.11.1 Adding vector images . . . . . . . . . . . . . . . . . . . . . 404<br>\n6.11.2 Implementing the config button . . . . . . . . . . . . . . . . 406<br>\n6.12 TMS XData: Monitoring critical server parameters . . . . . . . . . . . 406<br>\n6.12.1 Hardware being monitored . . . . . . . . . . . . . . . . . . 407<br>\n6.12.2 Getting the hardware info . . . . . . . . . . . . . . . . . . . 408<br>\n6.12.3 Implementing the service methods . . . . . . . . . . . . . . 415<br>\n6.13 TMS WEB Core: Adding monitoring to the Web client . . . . . . . . . 420<br>\n6.13.1 Updating the service controller . . . . . . . . . . . . . . . . 420<br>\n6.13.2 Adding the popup window . . . . . . . . . . . . . . . . . . . 425<br>\n6.13.3 Appearance of the caption . . . . . . . . . . . . . . . . . . . 434<br>\n6.13.4 Closing the pop-up window . . . . . . . . . . . . . . . . . . 435<br>\n6.13.5 Showing the pop-up window . . . . . . . . . . . . . . . . . 435<br>\n6.14 TMS Miletus: Creating a Windows client . . . . . . . . . . . . . . . . 438<br>\n6.14.1 Looking at the finished application . . . . . . . . . . . . . . 440<br>\n6.14.2 Create a new TMS Miletus application . . . . . . . . . . . . 443<br>\n6.14.3 Updating the project file . . . . . . . . . . . . . . . . . . . . 445<br>\n6.14.4 Migrating the service controller . . . . . . . . . . . . . . . . 445<br>\n6.14.5 Migrating the main form . . . . . . . . . . . . . . . . . . . . 446<br>\n6.14.6 Updating the pop-up window . . . . . . . . . . . . . . . . . 449<br>\n6.14.7 Running the application . . . . . . . . . . . . . . . . . . . . 451<\/p>\n<p>7 Appendix<br>\n7.1 Internet Component Suite (ICS) . . . . . . . . . . . . . . . . . . . . . 453<br>\n7.1.1 Download . . . . . . . . . . . . . . . . . . . . . . . . . . . . 453<br>\n7.1.2 List of components . . . . . . . . . . . . . . . . . . . . . . . 454<br>\n7.1.3 List of examples . . . . . . . . . . . . . . . . . . . . . . . . 455<br>\n7.1.4 Legal . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 456<br>\n7.2 TColors . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 457<br>\n7.3 References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 459<\/p><p>1 Preface\n1.1 About the series . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17<br>\n1.2 Required programming skills . . . . . . . . . . . . . . . . . . . . . . 18<br>\n1.3 Structure of the book . . . . . . . . . . . . . . . . . . . . . . . . . . . 18<br>\n1.4 Technical review . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19<br>\n1.5 Author . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19<\/p>\n<p>2 Introduction<br>\n2.1 Required licenses . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21<br>\n2.2 Downloading the source code . . . . . . . . . . . . . . . . . . . . . . 23<br>\n2.3 Disclaimer . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24<br>\n2.4 Typesetting . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25<br>\n2.4.1 Screenshots . . . . . . . . . . . . . . . . . . . . . . . . . . . 25<br>\n2.4.2 Source code . . . . . . . . . . . . . . . . . . . . . . . . . . . 25<br>\n2.4.3 Keyboard and mouse . . . . . . . . . . . . . . . . . . . . . . 26<br>\n2.4.4 References to other books . . . . . . . . . . . . . . . . . . . 26<br>\n2.5 Getting help reproducing the examples . . . . . . . . . . . . . . . . . 26<\/p>\n<p><strong>I VCL Grid Controls<\/strong><\/p>\n<p>3 TAdvStringGrid<br>\n3.1 Compatibility with Delphi versions . . . . . . . . . . . . . . . . . . . 29<br>\n3.2 Getting started . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30<br>\n3.2.1 Cell types . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30<br>\n3.2.2 Dimensions . . . . . . . . . . . . . . . . . . . . . . . . . . . 30<br>\n3.2.3 Writing text into cells . . . . . . . . . . . . . . . . . . . . . 34<br>\n3.2.4 Handling mouse clicks . . . . . . . . . . . . . . . . . . . . . 36<br>\n3.2.4.1 OnCellClick with row selection . . . . . . . . . . . . 36<br>\n3.2.4.2 Determine selected cell(s) without mouse click . . . 37<br>\n3.2.4.3 Determine selected rows(s) without mouse click . . 38<br>\n3.2.5 Changing dimensions . . . . . . . . . . . . . . . . . . . . . 38<br>\n3.2.6 Quickly generating test data . . . . . . . . . . . . . . . . . . 38<br>\n3.2.7 Bundled examples . . . . . . . . . . . . . . . . . . . . . . . 41<br>\n3.2.7.1 List of examples . . . . . . . . . . . . . . . . . . . . 42<br>\n3.2.7.2 Locating the examples . . . . . . . . . . . . . . . . . 44<br>\n3.2.8 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45<br>\n3.3 Static, virtual, and dynamic cells . . . . . . . . . . . . . . . . . . . . 45<br>\n3.3.1 Static cell properties . . . . . . . . . . . . . . . . . . . . . . 46<br>\n3.3.2 Using virtual cells . . . . . . . . . . . . . . . . . . . . . . . 48<br>\n3.3.2.1 Changing cell data for display . . . . . . . . . . . . . 50<br>\n3.3.2.2 Provide data on demand using virtual cells . . . . . 53<br>\n3.3.3 Dynamic cell properties . . . . . . . . . . . . . . . . . . . . 54<br>\n3.3.3.1 State of the grid . . . . . . . . . . . . . . . . . . . . 54<br>\n3.3.3.2 Color . . . . . . . . . . . . . . . . . . . . . . . . . . 56<br>\n3.3.3.3 Color gradient . . . . . . . . . . . . . . . . . . . . . 57<br>\n3.3.3.4 Alignment . . . . . . . . . . . . . . . . . . . . . . . 59<br>\n3.3.3.5 Mouse cursor . . . . . . . . . . . . . . . . . . . . . . 61<br>\n3.4 Using HTML . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 62<br>\n3.4.1 Images stored in PictureContainer and GridImages . . . . . 63<br>\n3.4.2 Supported tags . . . . . . . . . . . . . . . . . . . . . . . . . 64<br>\n3.4.3 Where to insert HTML tags . . . . . . . . . . . . . . . . . . 76<br>\n3.5 Organizing rows and columns . . . . . . . . . . . . . . . . . . . . . . 76<br>\n3.5.1 Size . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76<br>\n3.5.1.1 Persisting column widths . . . . . . . . . . . . . . . 79<br>\n3.5.1.2 Stretching . . . . . . . . . . . . . . . . . . . . . . . 79<br>\n3.5.2 Reordering (moving) . . . . . . . . . . . . . . . . . . . . . . 81<br>\n3.5.3 Hidden columns and rows . . . . . . . . . . . . . . . . . . . 85<br>\n3.5.4 Merging . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 91<br>\n3.5.5 Grouping . . . . . . . . . . . . . . . . . . . . . . . . . . . . 93<br>\n3.6 Loading and writing grid data . . . . . . . . . . . . . . . . . . . . . . 98<br>\n3.6.1 Customizing saving and loading . . . . . . . . . . . . . . . . 100<br>\n3.6.2 Creating PDF files . . . . . . . . . . . . . . . . . . . . . . . 101<br>\n3.6.2.1 Document options . . . . . . . . . . . . . . . . . . . 101<br>\n3.6.2.2 Document information . . . . . . . . . . . . . . . . 106<br>\n3.6.2.3 Example . . . . . . . . . . . . . . . . . . . . . . . . 106<br>\n3.7 Navigating . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 108<br>\n3.7.1 Keyboard . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110<br>\n3.7.2 Mouse . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 119<br>\n3.8 Sorting . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 125<br>\n3.8.1 Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 126<br>\n3.8.2 Storing and loading . . . . . . . . . . . . . . . . . . . . . . 130<br>\n3.8.3 Sort styles . . . . . . . . . . . . . . . . . . . . . . . . . . . . 131<br>\n3.8.3.1 Manually specifying the cell format . . . . . . . . . 133<br>\n3.8.3.2 Custom sorting . . . . . . . . . . . . . . . . . . . . . 134<br>\n3.8.4 Events . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 136<br>\n3.8.5 Ignoring columns . . . . . . . . . . . . . . . . . . . . . . . . 138<br>\n3.8.6 Row indexes before and after sorting . . . . . . . . . . . . . 139<br>\n3.8.7 Triggering sorting at run-time . . . . . . . . . . . . . . . . . 139<br>\n3.8.7.1 Single column . . . . . . . . . . . . . . . . . . . . . 140<br>\n3.8.7.2 Sort column sequences . . . . . . . . . . . . . . . . 140<br>\n3.8.8 Example . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 141<br>\n3.9 Editing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 144<br>\n3.9.1 Enabling editing for all cells . . . . . . . . . . . . . . . . . . 145<br>\n3.9.2 Read-only cells . . . . . . . . . . . . . . . . . . . . . . . . . 147<br>\n3.9.3 Starting the edit process using code . . . . . . . . . . . . . . 148<br>\n3.9.4 Inplace editors . . . . . . . . . . . . . . . . . . . . . . . . . 148<br>\n3.9.4.1 Defining an inplace editor . . . . . . . . . . . . . . . 150<br>\n3.9.4.2 Restricting the length of input . . . . . . . . . . . . 151<br>\n3.9.4.3 Using masks . . . . . . . . . . . . . . . . . . . . . . 151<br>\n3.9.4.4 Spin editors . . . . . . . . . . . . . . . . . . . . . . . 154<br>\n3.9.4.5 Combo boxes . . . . . . . . . . . . . . . . . . . . . . 156<br>\n3.9.5 Validating user input . . . . . . . . . . . . . . . . . . . . . . 160<br>\n3.10 Undo & Redo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 163<\/p>\n<p>4 TDBAdvGrid: Data-aware TAdvStringGrid<br>\n4.1 How is data linked to the grid? . . . . . . . . . . . . . . . . . . . . . 169<br>\n4.1.1 Assigning the datasource . . . . . . . . . . . . . . . . . . . . 169<br>\n4.1.2 Defining columns . . . . . . . . . . . . . . . . . . . . . . . . 169<br>\n4.2 PageMode is key! . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 170<br>\n4.3 EditPostMode determines when data is posted . . . . . . . . . . . . . 171<\/p>\n<p><strong>II Hands-on Examples<\/strong><\/p>\n<p>5 Assorted grid examples<br>\n5.1 VCL: Loading big CSV data files asynchronously . . . . . . . . . . . . 175<br>\n5.1.1 Downloading the data . . . . . . . . . . . . . . . . . . . . . 176<br>\n5.1.2 Why we use a resource . . . . . . . . . . . . . . . . . . . . . 178<br>\n5.1.3 Adding the resource . . . . . . . . . . . . . . . . . . . . . . 180<br>\n5.1.4 Loading the resource at run-time . . . . . . . . . . . . . . . 184<br>\n5.1.5 Indicating activity . . . . . . . . . . . . . . . . . . . . . . . 186<br>\n5.1.6 Loading data asynchronously . . . . . . . . . . . . . . . . . 188<br>\n5.2 Browsing data from an SQLite database . . . . . . . . . . . . . . . . 195<br>\n5.2.1 Creating an SQLite database with Array DML . . . . . . . . 196<br>\n5.2.2 Changing the browser app to SQLite . . . . . . . . . . . . . 202<br>\n5.3 Browsing data with a filter . . . . . . . . . . . . . . . . . . . . . . . . 208<br>\n5.3.1 Populating the combo box . . . . . . . . . . . . . . . . . . . 210<br>\n5.3.2 Showing only data for one state . . . . . . . . . . . . . . . . 211<br>\n5.3.3 Initializing the user interface . . . . . . . . . . . . . . . . . 211<br>\n5.3.4 Loading data for a state . . . . . . . . . . . . . . . . . . . . 214<br>\n5.3.5 Adding eye candy . . . . . . . . . . . . . . . . . . . . . . . . 216<br>\n5.4 Using vector images in TAdvStringGrid . . . . . . . . . . . . . . . . . 217<br>\n5.4.1 Components on the main form . . . . . . . . . . . . . . . . 219<br>\n5.4.2 Application Settings . . . . . . . . . . . . . . . . . . . . . . 227<br>\n5.4.3 TIconItem: Container for icons . . . . . . . . . . . . . . . . 230<br>\n5.4.4 Fields and properties of the main form . . . . . . . . . . . . 231<br>\n5.4.5 Setting up the grid . . . . . . . . . . . . . . . . . . . . . . . 234<br>\n5.4.6 Folder selection . . . . . . . . . . . . . . . . . . . . . . . . . 238<br>\n5.4.7 Updating the image list . . . . . . . . . . . . . . . . . . . . 239<br>\n5.4.8 Loading icons from a folder . . . . . . . . . . . . . . . . . . 240<br>\n5.4.9 Loading icons stored in a ZIP archive . . . . . . . . . . . . . 242<br>\n5.4.10 Export to Microsoft Excel . . . . . . . . . . . . . . . . . . . 245<br>\n5.4.11 Reacting to display resolution changes . . . . . . . . . . . . 247<\/p>\n<p>6 Multi-tier, cross-platform development<br>\n6.1 Building the database . . . . . . . . . . . . . . . . . . . . . . . . . . 251<br>\n6.1.1 Creating the database . . . . . . . . . . . . . . . . . . . . . 252<br>\n6.1.2 Postal code table . . . . . . . . . . . . . . . . . . . . . . . . 254<br>\n6.1.2.1 Source . . . . . . . . . . . . . . . . . . . . . . . . . 254<br>\n6.1.2.2 Usage restrictions . . . . . . . . . . . . . . . . . . . 254<br>\n6.1.2.3 Attributes . . . . . . . . . . . . . . . . . . . . . . . . 256<br>\n6.1.2.4 Creating the table . . . . . . . . . . . . . . . . . . . 256<br>\n6.1.2.5 Sample data . . . . . . . . . . . . . . . . . . . . . . 257<br>\n6.1.3 Country codes . . . . . . . . . . . . . . . . . . . . . . . . . 257<br>\n6.1.3.1 Source . . . . . . . . . . . . . . . . . . . . . . . . . 258<br>\n6.1.3.2 Usage restrictions . . . . . . . . . . . . . . . . . . . 258<br>\n6.1.3.3 Attributes . . . . . . . . . . . . . . . . . . . . . . . . 258<br>\n6.1.3.4 Creating the table . . . . . . . . . . . . . . . . . . . 258<br>\n6.1.3.5 Sample data . . . . . . . . . . . . . . . . . . . . . . 260<br>\n6.2 TMS XData: Web services . . . . . . . . . . . . . . . . . . . . . . . . 260<br>\n6.2.1 Creating the server application . . . . . . . . . . . . . . . . 261<br>\n6.2.2 Class for Web service data . . . . . . . . . . . . . . . . . . . 262<br>\n6.2.3 Database access . . . . . . . . . . . . . . . . . . . . . . . . . 266<br>\n6.2.4 Providing a connection . . . . . . . . . . . . . . . . . . . . . 268<br>\n6.2.5 Using the GetConnection method . . . . . . . . . . . . . . . 271<br>\n6.2.6 Querying the database . . . . . . . . . . . . . . . . . . . . . 272<br>\n6.2.7 Mandatory units . . . . . . . . . . . . . . . . . . . . . . . . 275<br>\n6.2.8 Defining the service interface . . . . . . . . . . . . . . . . . 275<br>\n6.2.9 Implementing the service method . . . . . . . . . . . . . . . 278<br>\n6.2.10 Database client libraries . . . . . . . . . . . . . . . . . . . . 280<br>\n6.2.11 Adding a custom route . . . . . . . . . . . . . . . . . . . . . 282<br>\n6.2.12 Browse your services with Swagger UI . . . . . . . . . . . . 283<br>\n6.2.13 Adding documentation for Swagger UI . . . . . . . . . . . . 287<br>\n6.2.13.1 XMLDoc in Delphi . . . . . . . . . . . . . . . . . . . 292<br>\n6.2.13.2 Swagger-specific tags . . . . . . . . . . . . . . . . . 292<br>\n6.2.13.3 Excluding methods from Swagger . . . . . . . . . . 294<br>\n6.3 VCL: Implementing a desktop client for lookup . . . . . . . . . . . . 295<br>\n6.3.1 Designing the main form . . . . . . . . . . . . . . . . . . . . 296<br>\n6.3.2 Retrieving data from the Web service . . . . . . . . . . . . . 298<br>\n6.3.3 Implementing the user events . . . . . . . . . . . . . . . . . 303<br>\n6.3.4 Customizing the grid control . . . . . . . . . . . . . . . . . 304<br>\n6.3.5 A word on T(Virtual)ImageList . . . . . . . . . . . . . . . . 305<br>\n6.4 FMX: Mobile app to lookup postal codes . . . . . . . . . . . . . . . . 305<br>\n6.4.1 The worst...comes first . . . . . . . . . . . . . . . . . . . . . 306<br>\n6.4.2 HTTP and HTTPS in Android apps . . . . . . . . . . . . . . 306<br>\n6.4.3 Building the user interface . . . . . . . . . . . . . . . . . . . 308<br>\n6.4.4 Retrieving data from the Web service . . . . . . . . . . . . . 311<br>\n6.5 TMS WEB Core: Web client application . . . . . . . . . . . . . . . . . 315<br>\n6.5.1 Designing the main form . . . . . . . . . . . . . . . . . . . . 316<br>\n6.5.2 Connecting to the XData server . . . . . . . . . . . . . . . . 318<br>\n6.5.3 Calling the service method . . . . . . . . . . . . . . . . . . . 318<br>\n6.5.4 Processing the result and updating the grid . . . . . . . . . 319<br>\n6.6 VCL: Using the Web service for efficient data entry . . . . . . . . . . 323<br>\n6.6.1 Designing the user interface . . . . . . . . . . . . . . . . . . 325<br>\n6.6.2 Fields and constants in the form . . . . . . . . . . . . . . . 325<br>\n6.6.3 Initializing the form and grid . . . . . . . . . . . . . . . . . 327<br>\n6.6.4 Saving and loading the grid values . . . . . . . . . . . . . . 328<br>\n6.6.5 Setup for editing . . . . . . . . . . . . . . . . . . . . . . . . 329<br>\n6.6.6 Retrieving data from the Web service . . . . . . . . . . . . . 331<br>\n6.6.7 Evaluating the size of Web service results . . . . . . . . . . 332<br>\n6.6.8 Validation of postal codes . . . . . . . . . . . . . . . . . . . 337<br>\n6.6.9 Selection from a combo box . . . . . . . . . . . . . . . . . . 338<br>\n6.7 TMS XData: Deployment as Windows service . . . . . . . . . . . . . 340<br>\n6.7.1 Windows application vs. Windows service . . . . . . . . . . 341<br>\n6.7.2 Migrating an existing server project . . . . . . . . . . . . . . 342<br>\n6.7.2.1 Thanks to Wagner Landgraf and outlook . . . . . . . 342<br>\n6.7.2.2 Adding service information to the service container . 343<br>\n6.7.2.3 Starting and stopping the server . . . . . . . . . . . 346<br>\n6.7.2.4 Adding the Windows service class . . . . . . . . . . 347<br>\n6.7.2.5 Helper methods to extend framework classes . . . . 349<br>\n6.7.2.6 Updating the project source file . . . . . . . . . . . . 350<br>\n6.7.2.7 Custom Command-line switch . . . . . . . . . . . . 353<br>\n6.8 TMS XData: Configuration of Web Services at run-time . . . . . . . . 353<br>\n6.8.1 Settings for IPostalService . . . . . . . . . . . . . . . . . . . 354<br>\n6.8.1.1 Settings for the database connection . . . . . . . . . 355<br>\n6.8.1.2 Settings for the server . . . . . . . . . . . . . . . . . 355<br>\n6.8.1.3 TServerSettings class . . . . . . . . . . . . . . . . . 355<br>\n6.8.1.4 Server status . . . . . . . . . . . . . . . . . . . . . . 359<br>\n6.8.2 Defining the configuration service . . . . . . . . . . . . . . . 359<br>\n6.8.3 Models, services, and endpoints . . . . . . . . . . . . . . . . 360<br>\n6.8.4 Implementing the configuration service . . . . . . . . . . . 361<br>\n6.8.5 Adding a second XData server . . . . . . . . . . . . . . . . . 362<br>\n6.8.5.1 Implementing the Singleton pattern . . . . . . . . . 364<br>\n6.8.5.2 Implementing methods to start and stop the data server . . . . . . . . . . . . . . . . . . . . . . . . . . 366<br>\n6.8.6 Adding services to the second XData server . . . . . . . . . 368<br>\n6.8.6.1 Updating the postal service . . . . . . . . . . . . . . 369<br>\n6.8.7 Adding start and stop to the configuration service . . . . . . 372<br>\n6.8.8 Automatic reservation of endpoints . . . . . . . . . . . . . . 374<br>\n6.8.9 Using the configuration service . . . . . . . . . . . . . . . . 377<br>\n6.9 TMS WEB Core: Building a Web interface . . . . . . . . . . . . . . . 378<br>\n6.9.1 Designing the main form . . . . . . . . . . . . . . . . . . . . 378<br>\n6.9.2 Data module for XData connectivity . . . . . . . . . . . . . 385<br>\n6.9.3 Initiating the connection from the main form . . . . . . . . 387<br>\n6.9.4 Retrieving the server configuration . . . . . . . . . . . . . . 388<br>\n6.9.5 Sending settings to the server . . . . . . . . . . . . . . . . . 394<br>\n6.9.6 Starting the service . . . . . . . . . . . . . . . . . . . . . . . 397<br>\n6.9.7 Stopping the service . . . . . . . . . . . . . . . . . . . . . . 400<br>\n6.10 Adding a Web server to an XData server . . . . . . . . . . . . . . . . 401<br>\n6.11 VCL: Updating the user interface with vectors . . . . . . . . . . . . . 403<br>\n6.11.1 Adding vector images . . . . . . . . . . . . . . . . . . . . . 404<br>\n6.11.2 Implementing the config button . . . . . . . . . . . . . . . . 406<br>\n6.12 TMS XData: Monitoring critical server parameters . . . . . . . . . . . 406<br>\n6.12.1 Hardware being monitored . . . . . . . . . . . . . . . . . . 407<br>\n6.12.2 Getting the hardware info . . . . . . . . . . . . . . . . . . . 408<br>\n6.12.3 Implementing the service methods . . . . . . . . . . . . . . 415<br>\n6.13 TMS WEB Core: Adding monitoring to the Web client . . . . . . . . . 420<br>\n6.13.1 Updating the service controller . . . . . . . . . . . . . . . . 420<br>\n6.13.2 Adding the popup window . . . . . . . . . . . . . . . . . . . 425<br>\n6.13.3 Appearance of the caption . . . . . . . . . . . . . . . . . . . 434<br>\n6.13.4 Closing the pop-up window . . . . . . . . . . . . . . . . . . 435<br>\n6.13.5 Showing the pop-up window . . . . . . . . . . . . . . . . . 435<br>\n6.14 TMS Miletus: Creating a Windows client . . . . . . . . . . . . . . . . 438<br>\n6.14.1 Looking at the finished application . . . . . . . . . . . . . . 440<br>\n6.14.2 Create a new TMS Miletus application . . . . . . . . . . . . 443<br>\n6.14.3 Updating the project file . . . . . . . . . . . . . . . . . . . . 445<br>\n6.14.4 Migrating the service controller . . . . . . . . . . . . . . . . 445<br>\n6.14.5 Migrating the main form . . . . . . . . . . . . . . . . . . . . 446<br>\n6.14.6 Updating the pop-up window . . . . . . . . . . . . . . . . . 449<br>\n6.14.7 Running the application . . . . . . . . . . . . . . . . . . . . 451<\/p>\n<p>7 Appendix<br>\n7.1 Internet Component Suite (ICS) . . . . . . . . . . . . . . . . . . . . . 453<br>\n7.1.1 Download . . . . . . . . . . . . . . . . . . . . . . . . . . . . 453<br>\n7.1.2 List of components . . . . . . . . . . . . . . . . . . . . . . . 454<br>\n7.1.3 List of examples . . . . . . . . . . . . . . . . . . . . . . . . 455<br>\n7.1.4 Legal . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 456<br>\n7.2 TColors . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 457<br>\n7.3 References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 459<\/p>"
},{

"guid":"6ADEFCB8DA18EE118C5C32A5A9F17050",
"pagename":"",
"datalevel":3,
"dataversion":1,
"lang":"en",
"text":"<p>1 Preface<br>\n1.1 About the series . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17<br>\n1.2 Required programming skills . . . . . . . . . . . . . . . . . . . . . . 18<br>\n1.3 Structure of the book . . . . . . . . . . . . . . . . . . . . . . . . . . . 18<br>\n1.4 Technical review . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19<br>\n1.5 Author . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19<\/p>\n<p>2 Introduction<br>\n2.1 Required licenses . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21<br>\n2.2 Downloading the source code . . . . . . . . . . . . . . . . . . . . . . 23<br>\n2.3 Disclaimer . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24<br>\n2.4 Typesetting . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25<br>\n2.4.1 Screenshots . . . . . . . . . . . . . . . . . . . . . . . . . . . 25<br>\n2.4.2 Source code . . . . . . . . . . . . . . . . . . . . . . . . . . . 25<br>\n2.4.3 Keyboard and mouse . . . . . . . . . . . . . . . . . . . . . . 26<br>\n2.4.4 References to other books . . . . . . . . . . . . . . . . . . . 26<br>\n2.5 Getting help reproducing the examples . . . . . . . . . . . . . . . . . 26<\/p>\n<p><strong>I VCL Grid Controls<\/strong><\/p>\n<p>3 TAdvStringGrid<br>\n3.1 Compatibility with Delphi versions . . . . . . . . . . . . . . . . . . . 29<br>\n3.2 Getting started . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30<br>\n3.2.1 Cell types . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30<br>\n3.2.2 Dimensions . . . . . . . . . . . . . . . . . . . . . . . . . . . 30<br>\n3.2.3 Writing text into cells . . . . . . . . . . . . . . . . . . . . . 34<br>\n3.2.4 Handling mouse clicks . . . . . . . . . . . . . . . . . . . . . 36<br>\n3.2.4.1 OnCellClick with row selection . . . . . . . . . . . . 36<br>\n3.2.4.2 Determine selected cell(s) without mouse click . . . 37<br>\n3.2.4.3 Determine selected rows(s) without mouse click . . 38<br>\n3.2.5 Changing dimensions . . . . . . . . . . . . . . . . . . . . . 38<br>\n3.2.6 Quickly generating test data . . . . . . . . . . . . . . . . . . 38<br>\n3.2.7 Bundled examples . . . . . . . . . . . . . . . . . . . . . . . 41<br>\n3.2.7.1 List of examples . . . . . . . . . . . . . . . . . . . . 42<br>\n3.2.7.2 Locating the examples . . . . . . . . . . . . . . . . . 44<br>\n3.2.8 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45<br>\n3.3 Static, virtual, and dynamic cells . . . . . . . . . . . . . . . . . . . . 45<br>\n3.3.1 Static cell properties . . . . . . . . . . . . . . . . . . . . . . 46<br>\n3.3.2 Using virtual cells . . . . . . . . . . . . . . . . . . . . . . . 48<br>\n3.3.2.1 Changing cell data for display . . . . . . . . . . . . . 50<br>\n3.3.2.2 Provide data on demand using virtual cells . . . . . 53<br>\n3.3.3 Dynamic cell properties . . . . . . . . . . . . . . . . . . . . 54<br>\n3.3.3.1 State of the grid . . . . . . . . . . . . . . . . . . . . 54<br>\n3.3.3.2 Color . . . . . . . . . . . . . . . . . . . . . . . . . . 56<br>\n3.3.3.3 Color gradient . . . . . . . . . . . . . . . . . . . . . 57<br>\n3.3.3.4 Alignment . . . . . . . . . . . . . . . . . . . . . . . 59<br>\n3.3.3.5 Mouse cursor . . . . . . . . . . . . . . . . . . . . . . 61<br>\n3.4 Using HTML . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 62<br>\n3.4.1 Images stored in PictureContainer and GridImages . . . . . 63<br>\n3.4.2 Supported tags . . . . . . . . . . . . . . . . . . . . . . . . . 64<br>\n3.4.3 Where to insert HTML tags . . . . . . . . . . . . . . . . . . 76<br>\n3.5 Organizing rows and columns . . . . . . . . . . . . . . . . . . . . . . 76<br>\n3.5.1 Size . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76<br>\n3.5.1.1 Persisting column widths . . . . . . . . . . . . . . . 79<br>\n3.5.1.2 Stretching . . . . . . . . . . . . . . . . . . . . . . . 79<br>\n3.5.2 Reordering (moving) . . . . . . . . . . . . . . . . . . . . . . 81<br>\n3.5.3 Hidden columns and rows . . . . . . . . . . . . . . . . . . . 85<br>\n3.5.4 Merging . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 91<br>\n3.5.5 Grouping . . . . . . . . . . . . . . . . . . . . . . . . . . . . 93<br>\n3.6 Loading and writing grid data . . . . . . . . . . . . . . . . . . . . . . 98<br>\n3.6.1 Customizing saving and loading . . . . . . . . . . . . . . . . 100<br>\n3.6.2 Creating PDF files . . . . . . . . . . . . . . . . . . . . . . . 101<br>\n3.6.2.1 Document options . . . . . . . . . . . . . . . . . . . 101<br>\n3.6.2.2 Document information . . . . . . . . . . . . . . . . 106<br>\n3.6.2.3 Example . . . . . . . . . . . . . . . . . . . . . . . . 106<br>\n3.7 Navigating . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 108<br>\n3.7.1 Keyboard . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110<br>\n3.7.2 Mouse . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 119<br>\n3.8 Sorting . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 125<br>\n3.8.1 Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 126<br>\n3.8.2 Storing and loading . . . . . . . . . . . . . . . . . . . . . . 130<br>\n3.8.3 Sort styles . . . . . . . . . . . . . . . . . . . . . . . . . . . . 131<br>\n3.8.3.1 Manually specifying the cell format . . . . . . . . . 133<br>\n3.8.3.2 Custom sorting . . . . . . . . . . . . . . . . . . . . . 134<br>\n3.8.4 Events . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 136<br>\n3.8.5 Ignoring columns . . . . . . . . . . . . . . . . . . . . . . . . 138<br>\n3.8.6 Row indexes before and after sorting . . . . . . . . . . . . . 139<br>\n3.8.7 Triggering sorting at run-time . . . . . . . . . . . . . . . . . 139<br>\n3.8.7.1 Single column . . . . . . . . . . . . . . . . . . . . . 140<br>\n3.8.7.2 Sort column sequences . . . . . . . . . . . . . . . . 140<br>\n3.8.8 Example . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 141<br>\n3.9 Editing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 144<br>\n3.9.1 Enabling editing for all cells . . . . . . . . . . . . . . . . . . 145<br>\n3.9.2 Read-only cells . . . . . . . . . . . . . . . . . . . . . . . . . 147<br>\n3.9.3 Starting the edit process using code . . . . . . . . . . . . . . 148<br>\n3.9.4 Inplace editors . . . . . . . . . . . . . . . . . . . . . . . . . 148<br>\n3.9.4.1 Defining an inplace editor . . . . . . . . . . . . . . . 150<br>\n3.9.4.2 Restricting the length of input . . . . . . . . . . . . 151<br>\n3.9.4.3 Using masks . . . . . . . . . . . . . . . . . . . . . . 151<br>\n3.9.4.4 Spin editors . . . . . . . . . . . . . . . . . . . . . . . 154<br>\n3.9.4.5 Combo boxes . . . . . . . . . . . . . . . . . . . . . . 156<br>\n3.9.5 Validating user input . . . . . . . . . . . . . . . . . . . . . . 160<br>\n3.10 Undo & Redo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 163<\/p>\n<p>4 TDBAdvGrid: Data-aware TAdvStringGrid<br>\n4.1 How is data linked to the grid? . . . . . . . . . . . . . . . . . . . . . 169<br>\n4.1.1 Assigning the datasource . . . . . . . . . . . . . . . . . . . . 169<br>\n4.1.2 Defining columns . . . . . . . . . . . . . . . . . . . . . . . . 169<br>\n4.2 PageMode is key! . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 170<br>\n4.3 EditPostMode determines when data is posted . . . . . . . . . . . . . 171<\/p>\n<p><strong>II Hands-on Examples<\/strong><\/p>\n<p>5 Assorted grid examples<br>\n5.1 VCL: Loading big CSV data files asynchronously . . . . . . . . . . . . 175<br>\n5.1.1 Downloading the data . . . . . . . . . . . . . . . . . . . . . 176<br>\n5.1.2 Why we use a resource . . . . . . . . . . . . . . . . . . . . . 178<br>\n5.1.3 Adding the resource . . . . . . . . . . . . . . . . . . . . . . 180<br>\n5.1.4 Loading the resource at run-time . . . . . . . . . . . . . . . 184<br>\n5.1.5 Indicating activity . . . . . . . . . . . . . . . . . . . . . . . 186<br>\n5.1.6 Loading data asynchronously . . . . . . . . . . . . . . . . . 188<br>\n5.2 Browsing data from an SQLite database . . . . . . . . . . . . . . . . 195<br>\n5.2.1 Creating an SQLite database with Array DML . . . . . . . . 196<br>\n5.2.2 Changing the browser app to SQLite . . . . . . . . . . . . . 202<br>\n5.3 Browsing data with a filter . . . . . . . . . . . . . . . . . . . . . . . . 208<br>\n5.3.1 Populating the combo box . . . . . . . . . . . . . . . . . . . 210<br>\n5.3.2 Showing only data for one state . . . . . . . . . . . . . . . . 211<br>\n5.3.3 Initializing the user interface . . . . . . . . . . . . . . . . . 211<br>\n5.3.4 Loading data for a state . . . . . . . . . . . . . . . . . . . . 214<br>\n5.3.5 Adding eye candy . . . . . . . . . . . . . . . . . . . . . . . . 216<br>\n5.4 Using vector images in TAdvStringGrid . . . . . . . . . . . . . . . . . 217<br>\n5.4.1 Components on the main form . . . . . . . . . . . . . . . . 219<br>\n5.4.2 Application Settings . . . . . . . . . . . . . . . . . . . . . . 227<br>\n5.4.3 TIconItem: Container for icons . . . . . . . . . . . . . . . . 230<br>\n5.4.4 Fields and properties of the main form . . . . . . . . . . . . 231<br>\n5.4.5 Setting up the grid . . . . . . . . . . . . . . . . . . . . . . . 234<br>\n5.4.6 Folder selection . . . . . . . . . . . . . . . . . . . . . . . . . 238<br>\n5.4.7 Updating the image list . . . . . . . . . . . . . . . . . . . . 239<br>\n5.4.8 Loading icons from a folder . . . . . . . . . . . . . . . . . . 240<br>\n5.4.9 Loading icons stored in a ZIP archive . . . . . . . . . . . . . 242<br>\n5.4.10 Export to Microsoft Excel . . . . . . . . . . . . . . . . . . . 245<br>\n5.4.11 Reacting to display resolution changes . . . . . . . . . . . . 247<\/p>\n<p>6 Multi-tier, cross-platform development<br>\n6.1 Building the database . . . . . . . . . . . . . . . . . . . . . . . . . . 251<br>\n6.1.1 Creating the database . . . . . . . . . . . . . . . . . . . . . 252<br>\n6.1.2 Postal code table . . . . . . . . . . . . . . . . . . . . . . . . 254<br>\n6.1.2.1 Source . . . . . . . . . . . . . . . . . . . . . . . . . 254<br>\n6.1.2.2 Usage restrictions . . . . . . . . . . . . . . . . . . . 254<br>\n6.1.2.3 Attributes . . . . . . . . . . . . . . . . . . . . . . . . 256<br>\n6.1.2.4 Creating the table . . . . . . . . . . . . . . . . . . . 256<br>\n6.1.2.5 Sample data . . . . . . . . . . . . . . . . . . . . . . 257<br>\n6.1.3 Country codes . . . . . . . . . . . . . . . . . . . . . . . . . 257<br>\n6.1.3.1 Source . . . . . . . . . . . . . . . . . . . . . . . . . 258<br>\n6.1.3.2 Usage restrictions . . . . . . . . . . . . . . . . . . . 258<br>\n6.1.3.3 Attributes . . . . . . . . . . . . . . . . . . . . . . . . 258<br>\n6.1.3.4 Creating the table . . . . . . . . . . . . . . . . . . . 258<br>\n6.1.3.5 Sample data . . . . . . . . . . . . . . . . . . . . . . 260<br>\n6.2 TMS XData: Web services . . . . . . . . . . . . . . . . . . . . . . . . 260<br>\n6.2.1 Creating the server application . . . . . . . . . . . . . . . . 261<br>\n6.2.2 Class for Web service data . . . . . . . . . . . . . . . . . . . 262<br>\n6.2.3 Database access . . . . . . . . . . . . . . . . . . . . . . . . . 266<br>\n6.2.4 Providing a connection . . . . . . . . . . . . . . . . . . . . . 268<br>\n6.2.5 Using the GetConnection method . . . . . . . . . . . . . . . 271<br>\n6.2.6 Querying the database . . . . . . . . . . . . . . . . . . . . . 272<br>\n6.2.7 Mandatory units . . . . . . . . . . . . . . . . . . . . . . . . 275<br>\n6.2.8 Defining the service interface . . . . . . . . . . . . . . . . . 275<br>\n6.2.9 Implementing the service method . . . . . . . . . . . . . . . 278<br>\n6.2.10 Database client libraries . . . . . . . . . . . . . . . . . . . . 280<br>\n6.2.11 Adding a custom route . . . . . . . . . . . . . . . . . . . . . 282<br>\n6.2.12 Browse your services with Swagger UI . . . . . . . . . . . . 283<br>\n6.2.13 Adding documentation for Swagger UI . . . . . . . . . . . . 287<br>\n6.2.13.1 XMLDoc in Delphi . . . . . . . . . . . . . . . . . . . 292<br>\n6.2.13.2 Swagger-specific tags . . . . . . . . . . . . . . . . . 292<br>\n6.2.13.3 Excluding methods from Swagger . . . . . . . . . . 294<br>\n6.3 VCL: Implementing a desktop client for lookup . . . . . . . . . . . . 295<br>\n6.3.1 Designing the main form . . . . . . . . . . . . . . . . . . . . 296<br>\n6.3.2 Retrieving data from the Web service . . . . . . . . . . . . . 298<br>\n6.3.3 Implementing the user events . . . . . . . . . . . . . . . . . 303<br>\n6.3.4 Customizing the grid control . . . . . . . . . . . . . . . . . 304<br>\n6.3.5 A word on T(Virtual)ImageList . . . . . . . . . . . . . . . . 305<br>\n6.4 FMX: Mobile app to lookup postal codes . . . . . . . . . . . . . . . . 305<br>\n6.4.1 The worst...comes first . . . . . . . . . . . . . . . . . . . . . 306<br>\n6.4.2 HTTP and HTTPS in Android apps . . . . . . . . . . . . . . 306<br>\n6.4.3 Building the user interface . . . . . . . . . . . . . . . . . . . 308<br>\n6.4.4 Retrieving data from the Web service . . . . . . . . . . . . . 311<br>\n6.5 TMS WEB Core: Web client application . . . . . . . . . . . . . . . . . 315<br>\n6.5.1 Designing the main form . . . . . . . . . . . . . . . . . . . . 316<br>\n6.5.2 Connecting to the XData server . . . . . . . . . . . . . . . . 318<br>\n6.5.3 Calling the service method . . . . . . . . . . . . . . . . . . . 318<br>\n6.5.4 Processing the result and updating the grid . . . . . . . . . 319<br>\n6.6 VCL: Using the Web service for efficient data entry . . . . . . . . . . 323<br>\n6.6.1 Designing the user interface . . . . . . . . . . . . . . . . . . 325<br>\n6.6.2 Fields and constants in the form . . . . . . . . . . . . . . . 325<br>\n6.6.3 Initializing the form and grid . . . . . . . . . . . . . . . . . 327<br>\n6.6.4 Saving and loading the grid values . . . . . . . . . . . . . . 328<br>\n6.6.5 Setup for editing . . . . . . . . . . . . . . . . . . . . . . . . 329<br>\n6.6.6 Retrieving data from the Web service . . . . . . . . . . . . . 331<br>\n6.6.7 Evaluating the size of Web service results . . . . . . . . . . 332<br>\n6.6.8 Validation of postal codes . . . . . . . . . . . . . . . . . . . 337<br>\n6.6.9 Selection from a combo box . . . . . . . . . . . . . . . . . . 338<br>\n6.7 TMS XData: Deployment as Windows service . . . . . . . . . . . . . 340<br>\n6.7.1 Windows application vs. Windows service . . . . . . . . . . 341<br>\n6.7.2 Migrating an existing server project . . . . . . . . . . . . . . 342<br>\n6.7.2.1 Thanks to Wagner Landgraf and outlook . . . . . . . 342<br>\n6.7.2.2 Adding service information to the service container . 343<br>\n6.7.2.3 Starting and stopping the server . . . . . . . . . . . 346<br>\n6.7.2.4 Adding the Windows service class . . . . . . . . . . 347<br>\n6.7.2.5 Helper methods to extend framework classes . . . . 349<br>\n6.7.2.6 Updating the project source file . . . . . . . . . . . . 350<br>\n6.7.2.7 Custom Command-line switch . . . . . . . . . . . . 353<br>\n6.8 TMS XData: Configuration of Web Services at run-time . . . . . . . . 353<br>\n6.8.1 Settings for IPostalService . . . . . . . . . . . . . . . . . . . 354<br>\n6.8.1.1 Settings for the database connection . . . . . . . . . 355<br>\n6.8.1.2 Settings for the server . . . . . . . . . . . . . . . . . 355<br>\n6.8.1.3 TServerSettings class . . . . . . . . . . . . . . . . . 355<br>\n6.8.1.4 Server status . . . . . . . . . . . . . . . . . . . . . . 359<br>\n6.8.2 Defining the configuration service . . . . . . . . . . . . . . . 359<br>\n6.8.3 Models, services, and endpoints . . . . . . . . . . . . . . . . 360<br>\n6.8.4 Implementing the configuration service . . . . . . . . . . . 361<br>\n6.8.5 Adding a second XData server . . . . . . . . . . . . . . . . . 362<br>\n6.8.5.1 Implementing the Singleton pattern . . . . . . . . . 364<br>\n6.8.5.2 Implementing methods to start and stop the data server . . . . . . . . . . . . . . . . . . . . . . . . . . 366<br>\n6.8.6 Adding services to the second XData server . . . . . . . . . 368<br>\n6.8.6.1 Updating the postal service . . . . . . . . . . . . . . 369<br>\n6.8.7 Adding start and stop to the configuration service . . . . . . 372<br>\n6.8.8 Automatic reservation of endpoints . . . . . . . . . . . . . . 374<br>\n6.8.9 Using the configuration service . . . . . . . . . . . . . . . . 377<br>\n6.9 TMS WEB Core: Building a Web interface . . . . . . . . . . . . . . . 378<br>\n6.9.1 Designing the main form . . . . . . . . . . . . . . . . . . . . 378<br>\n6.9.2 Data module for XData connectivity . . . . . . . . . . . . . 385<br>\n6.9.3 Initiating the connection from the main form . . . . . . . . 387<br>\n6.9.4 Retrieving the server configuration . . . . . . . . . . . . . . 388<br>\n6.9.5 Sending settings to the server . . . . . . . . . . . . . . . . . 394<br>\n6.9.6 Starting the service . . . . . . . . . . . . . . . . . . . . . . . 397<br>\n6.9.7 Stopping the service . . . . . . . . . . . . . . . . . . . . . . 400<br>\n6.10 Adding a Web server to an XData server . . . . . . . . . . . . . . . . 401<br>\n6.11 VCL: Updating the user interface with vectors . . . . . . . . . . . . . 403<br>\n6.11.1 Adding vector images . . . . . . . . . . . . . . . . . . . . . 404<br>\n6.11.2 Implementing the config button . . . . . . . . . . . . . . . . 406<br>\n6.12 TMS XData: Monitoring critical server parameters . . . . . . . . . . . 406<br>\n6.12.1 Hardware being monitored . . . . . . . . . . . . . . . . . . 407<br>\n6.12.2 Getting the hardware info . . . . . . . . . . . . . . . . . . . 408<br>\n6.12.3 Implementing the service methods . . . . . . . . . . . . . . 415<br>\n6.13 TMS WEB Core: Adding monitoring to the Web client . . . . . . . . . 420<br>\n6.13.1 Updating the service controller . . . . . . . . . . . . . . . . 420<br>\n6.13.2 Adding the popup window . . . . . . . . . . . . . . . . . . . 425<br>\n6.13.3 Appearance of the caption . . . . . . . . . . . . . . . . . . . 434<br>\n6.13.4 Closing the pop-up window . . . . . . . . . . . . . . . . . . 435<br>\n6.13.5 Showing the pop-up window . . . . . . . . . . . . . . . . . 435<br>\n6.14 TMS Miletus: Creating a Windows client . . . . . . . . . . . . . . . . 438<br>\n6.14.1 Looking at the finished application . . . . . . . . . . . . . . 440<br>\n6.14.2 Create a new TMS Miletus application . . . . . . . . . . . . 443<br>\n6.14.3 Updating the project file . . . . . . . . . . . . . . . . . . . . 445<br>\n6.14.4 Migrating the service controller . . . . . . . . . . . . . . . . 445<br>\n6.14.5 Migrating the main form . . . . . . . . . . . . . . . . . . . . 446<br>\n6.14.6 Updating the pop-up window . . . . . . . . . . . . . . . . . 449<br>\n6.14.7 Running the application . . . . . . . . . . . . . . . . . . . . 451<\/p>\n<p>7 Appendix<br>\n7.1 Internet Component Suite (ICS) . . . . . . . . . . . . . . . . . . . . . 453<br>\n7.1.1 Download . . . . . . . . . . . . . . . . . . . . . . . . . . . . 453<br>\n7.1.2 List of components . . . . . . . . . . . . . . . . . . . . . . . 454<br>\n7.1.3 List of examples . . . . . . . . . . . . . . . . . . . . . . . . 455<br>\n7.1.4 Legal . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 456<br>\n7.2 TColors . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 457<br>\n7.3 References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 459<\/p><p>1 Preface\n1.1 About the series . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17<br>\n1.2 Required programming skills . . . . . . . . . . . . . . . . . . . . . . 18<br>\n1.3 Structure of the book . . . . . . . . . . . . . . . . . . . . . . . . . . . 18<br>\n1.4 Technical review . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19<br>\n1.5 Author . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19<\/p>\n<p>2 Introduction<br>\n2.1 Required licenses . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21<br>\n2.2 Downloading the source code . . . . . . . . . . . . . . . . . . . . . . 23<br>\n2.3 Disclaimer . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24<br>\n2.4 Typesetting . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25<br>\n2.4.1 Screenshots . . . . . . . . . . . . . . . . . . . . . . . . . . . 25<br>\n2.4.2 Source code . . . . . . . . . . . . . . . . . . . . . . . . . . . 25<br>\n2.4.3 Keyboard and mouse . . . . . . . . . . . . . . . . . . . . . . 26<br>\n2.4.4 References to other books . . . . . . . . . . . . . . . . . . . 26<br>\n2.5 Getting help reproducing the examples . . . . . . . . . . . . . . . . . 26<\/p>\n<p><strong>I VCL Grid Controls<\/strong><\/p>\n<p>3 TAdvStringGrid<br>\n3.1 Compatibility with Delphi versions . . . . . . . . . . . . . . . . . . . 29<br>\n3.2 Getting started . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30<br>\n3.2.1 Cell types . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30<br>\n3.2.2 Dimensions . . . . . . . . . . . . . . . . . . . . . . . . . . . 30<br>\n3.2.3 Writing text into cells . . . . . . . . . . . . . . . . . . . . . 34<br>\n3.2.4 Handling mouse clicks . . . . . . . . . . . . . . . . . . . . . 36<br>\n3.2.4.1 OnCellClick with row selection . . . . . . . . . . . . 36<br>\n3.2.4.2 Determine selected cell(s) without mouse click . . . 37<br>\n3.2.4.3 Determine selected rows(s) without mouse click . . 38<br>\n3.2.5 Changing dimensions . . . . . . . . . . . . . . . . . . . . . 38<br>\n3.2.6 Quickly generating test data . . . . . . . . . . . . . . . . . . 38<br>\n3.2.7 Bundled examples . . . . . . . . . . . . . . . . . . . . . . . 41<br>\n3.2.7.1 List of examples . . . . . . . . . . . . . . . . . . . . 42<br>\n3.2.7.2 Locating the examples . . . . . . . . . . . . . . . . . 44<br>\n3.2.8 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45<br>\n3.3 Static, virtual, and dynamic cells . . . . . . . . . . . . . . . . . . . . 45<br>\n3.3.1 Static cell properties . . . . . . . . . . . . . . . . . . . . . . 46<br>\n3.3.2 Using virtual cells . . . . . . . . . . . . . . . . . . . . . . . 48<br>\n3.3.2.1 Changing cell data for display . . . . . . . . . . . . . 50<br>\n3.3.2.2 Provide data on demand using virtual cells . . . . . 53<br>\n3.3.3 Dynamic cell properties . . . . . . . . . . . . . . . . . . . . 54<br>\n3.3.3.1 State of the grid . . . . . . . . . . . . . . . . . . . . 54<br>\n3.3.3.2 Color . . . . . . . . . . . . . . . . . . . . . . . . . . 56<br>\n3.3.3.3 Color gradient . . . . . . . . . . . . . . . . . . . . . 57<br>\n3.3.3.4 Alignment . . . . . . . . . . . . . . . . . . . . . . . 59<br>\n3.3.3.5 Mouse cursor . . . . . . . . . . . . . . . . . . . . . . 61<br>\n3.4 Using HTML . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 62<br>\n3.4.1 Images stored in PictureContainer and GridImages . . . . . 63<br>\n3.4.2 Supported tags . . . . . . . . . . . . . . . . . . . . . . . . . 64<br>\n3.4.3 Where to insert HTML tags . . . . . . . . . . . . . . . . . . 76<br>\n3.5 Organizing rows and columns . . . . . . . . . . . . . . . . . . . . . . 76<br>\n3.5.1 Size . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76<br>\n3.5.1.1 Persisting column widths . . . . . . . . . . . . . . . 79<br>\n3.5.1.2 Stretching . . . . . . . . . . . . . . . . . . . . . . . 79<br>\n3.5.2 Reordering (moving) . . . . . . . . . . . . . . . . . . . . . . 81<br>\n3.5.3 Hidden columns and rows . . . . . . . . . . . . . . . . . . . 85<br>\n3.5.4 Merging . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 91<br>\n3.5.5 Grouping . . . . . . . . . . . . . . . . . . . . . . . . . . . . 93<br>\n3.6 Loading and writing grid data . . . . . . . . . . . . . . . . . . . . . . 98<br>\n3.6.1 Customizing saving and loading . . . . . . . . . . . . . . . . 100<br>\n3.6.2 Creating PDF files . . . . . . . . . . . . . . . . . . . . . . . 101<br>\n3.6.2.1 Document options . . . . . . . . . . . . . . . . . . . 101<br>\n3.6.2.2 Document information . . . . . . . . . . . . . . . . 106<br>\n3.6.2.3 Example . . . . . . . . . . . . . . . . . . . . . . . . 106<br>\n3.7 Navigating . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 108<br>\n3.7.1 Keyboard . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110<br>\n3.7.2 Mouse . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 119<br>\n3.8 Sorting . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 125<br>\n3.8.1 Options . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 126<br>\n3.8.2 Storing and loading . . . . . . . . . . . . . . . . . . . . . . 130<br>\n3.8.3 Sort styles . . . . . . . . . . . . . . . . . . . . . . . . . . . . 131<br>\n3.8.3.1 Manually specifying the cell format . . . . . . . . . 133<br>\n3.8.3.2 Custom sorting . . . . . . . . . . . . . . . . . . . . . 134<br>\n3.8.4 Events . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 136<br>\n3.8.5 Ignoring columns . . . . . . . . . . . . . . . . . . . . . . . . 138<br>\n3.8.6 Row indexes before and after sorting . . . . . . . . . . . . . 139<br>\n3.8.7 Triggering sorting at run-time . . . . . . . . . . . . . . . . . 139<br>\n3.8.7.1 Single column . . . . . . . . . . . . . . . . . . . . . 140<br>\n3.8.7.2 Sort column sequences . . . . . . . . . . . . . . . . 140<br>\n3.8.8 Example . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 141<br>\n3.9 Editing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 144<br>\n3.9.1 Enabling editing for all cells . . . . . . . . . . . . . . . . . . 145<br>\n3.9.2 Read-only cells . . . . . . . . . . . . . . . . . . . . . . . . . 147<br>\n3.9.3 Starting the edit process using code . . . . . . . . . . . . . . 148<br>\n3.9.4 Inplace editors . . . . . . . . . . . . . . . . . . . . . . . . . 148<br>\n3.9.4.1 Defining an inplace editor . . . . . . . . . . . . . . . 150<br>\n3.9.4.2 Restricting the length of input . . . . . . . . . . . . 151<br>\n3.9.4.3 Using masks . . . . . . . . . . . . . . . . . . . . . . 151<br>\n3.9.4.4 Spin editors . . . . . . . . . . . . . . . . . . . . . . . 154<br>\n3.9.4.5 Combo boxes . . . . . . . . . . . . . . . . . . . . . . 156<br>\n3.9.5 Validating user input . . . . . . . . . . . . . . . . . . . . . . 160<br>\n3.10 Undo & Redo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 163<\/p>\n<p>4 TDBAdvGrid: Data-aware TAdvStringGrid<br>\n4.1 How is data linked to the grid? . . . . . . . . . . . . . . . . . . . . . 169<br>\n4.1.1 Assigning the datasource . . . . . . . . . . . . . . . . . . . . 169<br>\n4.1.2 Defining columns . . . . . . . . . . . . . . . . . . . . . . . . 169<br>\n4.2 PageMode is key! . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 170<br>\n4.3 EditPostMode determines when data is posted . . . . . . . . . . . . . 171<\/p>\n<p><strong>II Hands-on Examples<\/strong><\/p>\n<p>5 Assorted grid examples<br>\n5.1 VCL: Loading big CSV data files asynchronously . . . . . . . . . . . . 175<br>\n5.1.1 Downloading the data . . . . . . . . . . . . . . . . . . . . . 176<br>\n5.1.2 Why we use a resource . . . . . . . . . . . . . . . . . . . . . 178<br>\n5.1.3 Adding the resource . . . . . . . . . . . . . . . . . . . . . . 180<br>\n5.1.4 Loading the resource at run-time . . . . . . . . . . . . . . . 184<br>\n5.1.5 Indicating activity . . . . . . . . . . . . . . . . . . . . . . . 186<br>\n5.1.6 Loading data asynchronously . . . . . . . . . . . . . . . . . 188<br>\n5.2 Browsing data from an SQLite database . . . . . . . . . . . . . . . . 195<br>\n5.2.1 Creating an SQLite database with Array DML . . . . . . . . 196<br>\n5.2.2 Changing the browser app to SQLite . . . . . . . . . . . . . 202<br>\n5.3 Browsing data with a filter . . . . . . . . . . . . . . . . . . . . . . . . 208<br>\n5.3.1 Populating the combo box . . . . . . . . . . . . . . . . . . . 210<br>\n5.3.2 Showing only data for one state . . . . . . . . . . . . . . . . 211<br>\n5.3.3 Initializing the user interface . . . . . . . . . . . . . . . . . 211<br>\n5.3.4 Loading data for a state . . . . . . . . . . . . . . . . . . . . 214<br>\n5.3.5 Adding eye candy . . . . . . . . . . . . . . . . . . . . . . . . 216<br>\n5.4 Using vector images in TAdvStringGrid . . . . . . . . . . . . . . . . . 217<br>\n5.4.1 Components on the main form . . . . . . . . . . . . . . . . 219<br>\n5.4.2 Application Settings . . . . . . . . . . . . . . . . . . . . . . 227<br>\n5.4.3 TIconItem: Container for icons . . . . . . . . . . . . . . . . 230<br>\n5.4.4 Fields and properties of the main form . . . . . . . . . . . . 231<br>\n5.4.5 Setting up the grid . . . . . . . . . . . . . . . . . . . . . . . 234<br>\n5.4.6 Folder selection . . . . . . . . . . . . . . . . . . . . . . . . . 238<br>\n5.4.7 Updating the image list . . . . . . . . . . . . . . . . . . . . 239<br>\n5.4.8 Loading icons from a folder . . . . . . . . . . . . . . . . . . 240<br>\n5.4.9 Loading icons stored in a ZIP archive . . . . . . . . . . . . . 242<br>\n5.4.10 Export to Microsoft Excel . . . . . . . . . . . . . . . . . . . 245<br>\n5.4.11 Reacting to display resolution changes . . . . . . . . . . . . 247<\/p>\n<p>6 Multi-tier, cross-platform development<br>\n6.1 Building the database . . . . . . . . . . . . . . . . . . . . . . . . . . 251<br>\n6.1.1 Creating the database . . . . . . . . . . . . . . . . . . . . . 252<br>\n6.1.2 Postal code table . . . . . . . . . . . . . . . . . . . . . . . . 254<br>\n6.1.2.1 Source . . . . . . . . . . . . . . . . . . . . . . . . . 254<br>\n6.1.2.2 Usage restrictions . . . . . . . . . . . . . . . . . . . 254<br>\n6.1.2.3 Attributes . . . . . . . . . . . . . . . . . . . . . . . . 256<br>\n6.1.2.4 Creating the table . . . . . . . . . . . . . . . . . . . 256<br>\n6.1.2.5 Sample data . . . . . . . . . . . . . . . . . . . . . . 257<br>\n6.1.3 Country codes . . . . . . . . . . . . . . . . . . . . . . . . . 257<br>\n6.1.3.1 Source . . . . . . . . . . . . . . . . . . . . . . . . . 258<br>\n6.1.3.2 Usage restrictions . . . . . . . . . . . . . . . . . . . 258<br>\n6.1.3.3 Attributes . . . . . . . . . . . . . . . . . . . . . . . . 258<br>\n6.1.3.4 Creating the table . . . . . . . . . . . . . . . . . . . 258<br>\n6.1.3.5 Sample data . . . . . . . . . . . . . . . . . . . . . . 260<br>\n6.2 TMS XData: Web services . . . . . . . . . . . . . . . . . . . . . . . . 260<br>\n6.2.1 Creating the server application . . . . . . . . . . . . . . . . 261<br>\n6.2.2 Class for Web service data . . . . . . . . . . . . . . . . . . . 262<br>\n6.2.3 Database access . . . . . . . . . . . . . . . . . . . . . . . . . 266<br>\n6.2.4 Providing a connection . . . . . . . . . . . . . . . . . . . . . 268<br>\n6.2.5 Using the GetConnection method . . . . . . . . . . . . . . . 271<br>\n6.2.6 Querying the database . . . . . . . . . . . . . . . . . . . . . 272<br>\n6.2.7 Mandatory units . . . . . . . . . . . . . . . . . . . . . . . . 275<br>\n6.2.8 Defining the service interface . . . . . . . . . . . . . . . . . 275<br>\n6.2.9 Implementing the service method . . . . . . . . . . . . . . . 278<br>\n6.2.10 Database client libraries . . . . . . . . . . . . . . . . . . . . 280<br>\n6.2.11 Adding a custom route . . . . . . . . . . . . . . . . . . . . . 282<br>\n6.2.12 Browse your services with Swagger UI . . . . . . . . . . . . 283<br>\n6.2.13 Adding documentation for Swagger UI . . . . . . . . . . . . 287<br>\n6.2.13.1 XMLDoc in Delphi . . . . . . . . . . . . . . . . . . . 292<br>\n6.2.13.2 Swagger-specific tags . . . . . . . . . . . . . . . . . 292<br>\n6.2.13.3 Excluding methods from Swagger . . . . . . . . . . 294<br>\n6.3 VCL: Implementing a desktop client for lookup . . . . . . . . . . . . 295<br>\n6.3.1 Designing the main form . . . . . . . . . . . . . . . . . . . . 296<br>\n6.3.2 Retrieving data from the Web service . . . . . . . . . . . . . 298<br>\n6.3.3 Implementing the user events . . . . . . . . . . . . . . . . . 303<br>\n6.3.4 Customizing the grid control . . . . . . . . . . . . . . . . . 304<br>\n6.3.5 A word on T(Virtual)ImageList . . . . . . . . . . . . . . . . 305<br>\n6.4 FMX: Mobile app to lookup postal codes . . . . . . . . . . . . . . . . 305<br>\n6.4.1 The worst...comes first . . . . . . . . . . . . . . . . . . . . . 306<br>\n6.4.2 HTTP and HTTPS in Android apps . . . . . . . . . . . . . . 306<br>\n6.4.3 Building the user interface . . . . . . . . . . . . . . . . . . . 308<br>\n6.4.4 Retrieving data from the Web service . . . . . . . . . . . . . 311<br>\n6.5 TMS WEB Core: Web client application . . . . . . . . . . . . . . . . . 315<br>\n6.5.1 Designing the main form . . . . . . . . . . . . . . . . . . . . 316<br>\n6.5.2 Connecting to the XData server . . . . . . . . . . . . . . . . 318<br>\n6.5.3 Calling the service method . . . . . . . . . . . . . . . . . . . 318<br>\n6.5.4 Processing the result and updating the grid . . . . . . . . . 319<br>\n6.6 VCL: Using the Web service for efficient data entry . . . . . . . . . . 323<br>\n6.6.1 Designing the user interface . . . . . . . . . . . . . . . . . . 325<br>\n6.6.2 Fields and constants in the form . . . . . . . . . . . . . . . 325<br>\n6.6.3 Initializing the form and grid . . . . . . . . . . . . . . . . . 327<br>\n6.6.4 Saving and loading the grid values . . . . . . . . . . . . . . 328<br>\n6.6.5 Setup for editing . . . . . . . . . . . . . . . . . . . . . . . . 329<br>\n6.6.6 Retrieving data from the Web service . . . . . . . . . . . . . 331<br>\n6.6.7 Evaluating the size of Web service results . . . . . . . . . . 332<br>\n6.6.8 Validation of postal codes . . . . . . . . . . . . . . . . . . . 337<br>\n6.6.9 Selection from a combo box . . . . . . . . . . . . . . . . . . 338<br>\n6.7 TMS XData: Deployment as Windows service . . . . . . . . . . . . . 340<br>\n6.7.1 Windows application vs. Windows service . . . . . . . . . . 341<br>\n6.7.2 Migrating an existing server project . . . . . . . . . . . . . . 342<br>\n6.7.2.1 Thanks to Wagner Landgraf and outlook . . . . . . . 342<br>\n6.7.2.2 Adding service information to the service container . 343<br>\n6.7.2.3 Starting and stopping the server . . . . . . . . . . . 346<br>\n6.7.2.4 Adding the Windows service class . . . . . . . . . . 347<br>\n6.7.2.5 Helper methods to extend framework classes . . . . 349<br>\n6.7.2.6 Updating the project source file . . . . . . . . . . . . 350<br>\n6.7.2.7 Custom Command-line switch . . . . . . . . . . . . 353<br>\n6.8 TMS XData: Configuration of Web Services at run-time . . . . . . . . 353<br>\n6.8.1 Settings for IPostalService . . . . . . . . . . . . . . . . . . . 354<br>\n6.8.1.1 Settings for the database connection . . . . . . . . . 355<br>\n6.8.1.2 Settings for the server . . . . . . . . . . . . . . . . . 355<br>\n6.8.1.3 TServerSettings class . . . . . . . . . . . . . . . . . 355<br>\n6.8.1.4 Server status . . . . . . . . . . . . . . . . . . . . . . 359<br>\n6.8.2 Defining the configuration service . . . . . . . . . . . . . . . 359<br>\n6.8.3 Models, services, and endpoints . . . . . . . . . . . . . . . . 360<br>\n6.8.4 Implementing the configuration service . . . . . . . . . . . 361<br>\n6.8.5 Adding a second XData server . . . . . . . . . . . . . . . . . 362<br>\n6.8.5.1 Implementing the Singleton pattern . . . . . . . . . 364<br>\n6.8.5.2 Implementing methods to start and stop the data server . . . . . . . . . . . . . . . . . . . . . . . . . . 366<br>\n6.8.6 Adding services to the second XData server . . . . . . . . . 368<br>\n6.8.6.1 Updating the postal service . . . . . . . . . . . . . . 369<br>\n6.8.7 Adding start and stop to the configuration service . . . . . . 372<br>\n6.8.8 Automatic reservation of endpoints . . . . . . . . . . . . . . 374<br>\n6.8.9 Using the configuration service . . . . . . . . . . . . . . . . 377<br>\n6.9 TMS WEB Core: Building a Web interface . . . . . . . . . . . . . . . 378<br>\n6.9.1 Designing the main form . . . . . . . . . . . . . . . . . . . . 378<br>\n6.9.2 Data module for XData connectivity . . . . . . . . . . . . . 385<br>\n6.9.3 Initiating the connection from the main form . . . . . . . . 387<br>\n6.9.4 Retrieving the server configuration . . . . . . . . . . . . . . 388<br>\n6.9.5 Sending settings to the server . . . . . . . . . . . . . . . . . 394<br>\n6.9.6 Starting the service . . . . . . . . . . . . . . . . . . . . . . . 397<br>\n6.9.7 Stopping the service . . . . . . . . . . . . . . . . . . . . . . 400<br>\n6.10 Adding a Web server to an XData server . . . . . . . . . . . . . . . . 401<br>\n6.11 VCL: Updating the user interface with vectors . . . . . . . . . . . . . 403<br>\n6.11.1 Adding vector images . . . . . . . . . . . . . . . . . . . . . 404<br>\n6.11.2 Implementing the config button . . . . . . . . . . . . . . . . 406<br>\n6.12 TMS XData: Monitoring critical server parameters . . . . . . . . . . . 406<br>\n6.12.1 Hardware being monitored . . . . . . . . . . . . . . . . . . 407<br>\n6.12.2 Getting the hardware info . . . . . . . . . . . . . . . . . . . 408<br>\n6.12.3 Implementing the service methods . . . . . . . . . . . . . . 415<br>\n6.13 TMS WEB Core: Adding monitoring to the Web client . . . . . . . . . 420<br>\n6.13.1 Updating the service controller . . . . . . . . . . . . . . . . 420<br>\n6.13.2 Adding the popup window . . . . . . . . . . . . . . . . . . . 425<br>\n6.13.3 Appearance of the caption . . . . . . . . . . . . . . . . . . . 434<br>\n6.13.4 Closing the pop-up window . . . . . . . . . . . . . . . . . . 435<br>\n6.13.5 Showing the pop-up window . . . . . . . . . . . . . . . . . 435<br>\n6.14 TMS Miletus: Creating a Windows client . . . . . . . . . . . . . . . . 438<br>\n6.14.1 Looking at the finished application . . . . . . . . . . . . . . 440<br>\n6.14.2 Create a new TMS Miletus application . . . . . . . . . . . . 443<br>\n6.14.3 Updating the project file . . . . . . . . . . . . . . . . . . . . 445<br>\n6.14.4 Migrating the service controller . . . . . . . . . . . . . . . . 445<br>\n6.14.5 Migrating the main form . . . . . . . . . . . . . . . . . . . . 446<br>\n6.14.6 Updating the pop-up window . . . . . . . . . . . . . . . . . 449<br>\n6.14.7 Running the application . . . . . . . . . . . . . . . . . . . . 451<\/p>\n<p>7 Appendix<br>\n7.1 Internet Component Suite (ICS) . . . . . . . . . . . . . . . . . . . . . 453<br>\n7.1.1 Download . . . . . . . . . . . . . . . . . . . . . . . . . . . . 453<br>\n7.1.2 List of components . . . . . . . . . . . . . . . . . . . . . . . 454<br>\n7.1.3 List of examples . . . . . . . . . . . . . . . . . . . . . . . . 455<br>\n7.1.4 Legal . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 456<br>\n7.2 TColors . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 457<br>\n7.3 References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 459<\/p>"}],
"keywords":[
]}